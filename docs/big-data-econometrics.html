<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Big Data Econometrics | Big Data Analytics</title>
  <meta name="description" content="A guide to practical big data analytics in R." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Big Data Econometrics | Big Data Analytics" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://umatter.github.io/BigData" />
  <meta property="og:image" content="https://umatter.github.io/BigDataimg/cover.png" />
  <meta property="og:description" content="A guide to practical big data analytics in R." />
  <meta name="github-repo" content="umatter/BigData" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Big Data Econometrics | Big Data Analytics" />
  
  <meta name="twitter:description" content="A guide to practical big data analytics in R." />
  <meta name="twitter:image" content="https://umatter.github.io/BigDataimg/cover.png" />

<meta name="author" content="Ulrich Matter" />


<meta name="date" content="2022-05-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction.html"/>
<link rel="next" href="software-programming-with-big-data.html"/>
<script src="libs/header-attrs/header-attrs.js"></script>
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets/htmlwidgets.js"></script>
<script src="libs/d3/d3.min.js"></script>
<link href="libs/profvis/profvis.css" rel="stylesheet" />
<script src="libs/profvis/profvis.js"></script>
<script src="libs/profvis/scroll.js"></script>
<link href="libs/highlight/textmate.css" rel="stylesheet" />
<script src="libs/highlight/highlight.js"></script>
<script src="libs/profvis-binding/profvis.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Big Data Analytics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-is-big-in-big-data"><i class="fa fa-check"></i><b>1.1</b> What is <em>big</em> in “Big Data?”</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#approaches-to-analyzing-big-data"><i class="fa fa-check"></i><b>1.2</b> Approaches to analyzing Big Data</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#content-overview"><i class="fa fa-check"></i><b>1.3</b> Content overview</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#prerequisits"><i class="fa fa-check"></i><b>1.4</b> Prerequisits</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="big-data-econometrics.html"><a href="big-data-econometrics.html"><i class="fa fa-check"></i><b>2</b> Big Data Econometrics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="big-data-econometrics.html"><a href="big-data-econometrics.html#a-practical-big-p-problem"><i class="fa fa-check"></i><b>2.1</b> A practical <em>big P</em> problem</a></li>
<li class="chapter" data-level="2.2" data-path="big-data-econometrics.html"><a href="big-data-econometrics.html#a-practical-big-n-problem"><i class="fa fa-check"></i><b>2.2</b> A practical <em>big N</em> problem</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="big-data-econometrics.html"><a href="big-data-econometrics.html#ols-as-a-point-of-reference"><i class="fa fa-check"></i><b>2.2.1</b> OLS as a point of reference</a></li>
<li class="chapter" data-level="2.2.2" data-path="big-data-econometrics.html"><a href="big-data-econometrics.html#the-uluru-algorithm-as-an-alternative-to-ols"><i class="fa fa-check"></i><b>2.2.2</b> The Uluru algorithm as an alternative to OLS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="software-programming-with-big-data.html"><a href="software-programming-with-big-data.html"><i class="fa fa-check"></i><b>3</b> Software: Programming with (Big) Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="software-programming-with-big-data.html"><a href="software-programming-with-big-data.html#domains-of-programming-with-big-data"><i class="fa fa-check"></i><b>3.1</b> Domains of programming with (big) data</a></li>
<li class="chapter" data-level="3.2" data-path="software-programming-with-big-data.html"><a href="software-programming-with-big-data.html#measuring-r-performance"><i class="fa fa-check"></i><b>3.2</b> Measuring R performance</a></li>
<li class="chapter" data-level="3.3" data-path="software-programming-with-big-data.html"><a href="software-programming-with-big-data.html#writing-efficient-r-code"><i class="fa fa-check"></i><b>3.3</b> Writing efficient R code</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="software-programming-with-big-data.html"><a href="software-programming-with-big-data.html#memory-allocation-and-growing-objects"><i class="fa fa-check"></i><b>3.3.1</b> Memory allocation and growing objects</a></li>
<li class="chapter" data-level="3.3.2" data-path="software-programming-with-big-data.html"><a href="software-programming-with-big-data.html#vectorization-in-basic-r-functions"><i class="fa fa-check"></i><b>3.3.2</b> Vectorization in basic R functions</a></li>
<li class="chapter" data-level="3.3.3" data-path="software-programming-with-big-data.html"><a href="software-programming-with-big-data.html#apply-type-functions-and-vectorization"><i class="fa fa-check"></i><b>3.3.3</b> <code>apply</code>-type functions and vectorization</a></li>
<li class="chapter" data-level="3.3.4" data-path="software-programming-with-big-data.html"><a href="software-programming-with-big-data.html#avoid-unnecessary-copying"><i class="fa fa-check"></i><b>3.3.4</b> Avoid unnecessary copying</a></li>
<li class="chapter" data-level="3.3.5" data-path="software-programming-with-big-data.html"><a href="software-programming-with-big-data.html#releasing-memory"><i class="fa fa-check"></i><b>3.3.5</b> Releasing memory</a></li>
<li class="chapter" data-level="3.3.6" data-path="software-programming-with-big-data.html"><a href="software-programming-with-big-data.html#beyond-r"><i class="fa fa-check"></i><b>3.3.6</b> Beyond R</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="software-programming-with-big-data.html"><a href="software-programming-with-big-data.html#sql-basics"><i class="fa fa-check"></i><b>3.4</b> SQL basics</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="software-programming-with-big-data.html"><a href="software-programming-with-big-data.html#first-steps-in-sqlite"><i class="fa fa-check"></i><b>3.4.1</b> First steps in SQL(ite)</a></li>
<li class="chapter" data-level="3.4.2" data-path="software-programming-with-big-data.html"><a href="software-programming-with-big-data.html#joins"><i class="fa fa-check"></i><b>3.4.2</b> Joins</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="hardware-computing-resources.html"><a href="hardware-computing-resources.html"><i class="fa fa-check"></i><b>4</b> Hardware: Computing Resources</a>
<ul>
<li class="chapter" data-level="4.1" data-path="hardware-computing-resources.html"><a href="hardware-computing-resources.html#components-of-a-standard-computing-environment"><i class="fa fa-check"></i><b>4.1</b> Components of a standard computing environment</a></li>
<li class="chapter" data-level="4.2" data-path="hardware-computing-resources.html"><a href="hardware-computing-resources.html#mass-storage"><i class="fa fa-check"></i><b>4.2</b> Mass storage</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="hardware-computing-resources.html"><a href="hardware-computing-resources.html#avoid-redundancies"><i class="fa fa-check"></i><b>4.2.1</b> Avoid redundancies</a></li>
<li class="chapter" data-level="4.2.2" data-path="hardware-computing-resources.html"><a href="hardware-computing-resources.html#data-compression"><i class="fa fa-check"></i><b>4.2.2</b> Data compression</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="hardware-computing-resources.html"><a href="hardware-computing-resources.html#random-access-memory-ram"><i class="fa fa-check"></i><b>4.3</b> Random access memory (RAM)</a></li>
<li class="chapter" data-level="4.4" data-path="hardware-computing-resources.html"><a href="hardware-computing-resources.html#combining-ram-and-hard-disk-virtual-memory"><i class="fa fa-check"></i><b>4.4</b> Combining RAM and hard-disk: virtual memory</a></li>
<li class="chapter" data-level="4.5" data-path="hardware-computing-resources.html"><a href="hardware-computing-resources.html#cpu-and-parallelization"><i class="fa fa-check"></i><b>4.5</b> CPU and parallelization</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="hardware-computing-resources.html"><a href="hardware-computing-resources.html#naive-multi-session-approach"><i class="fa fa-check"></i><b>4.5.1</b> Naive multi-session approach</a></li>
<li class="chapter" data-level="4.5.2" data-path="hardware-computing-resources.html"><a href="hardware-computing-resources.html#multi-core-and-multi-node-approach"><i class="fa fa-check"></i><b>4.5.2</b> Multi-core and multi-node approach</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="hardware-computing-resources.html"><a href="hardware-computing-resources.html#gpus-for-scientific-computing"><i class="fa fa-check"></i><b>4.6</b> GPUs for scientific computing</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="hardware-computing-resources.html"><a href="hardware-computing-resources.html#gpus-in-r"><i class="fa fa-check"></i><b>4.6.1</b> GPUs in R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="distributed-systems.html"><a href="distributed-systems.html"><i class="fa fa-check"></i><b>5</b> Distributed Systems</a>
<ul>
<li class="chapter" data-level="5.1" data-path="distributed-systems.html"><a href="distributed-systems.html#mapreduce"><i class="fa fa-check"></i><b>5.1</b> MapReduce</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="distributed-systems.html"><a href="distributed-systems.html#mapreduce-concept-illustrated-in-r"><i class="fa fa-check"></i><b>5.1.1</b> Map/Reduce Concept Illustrated in R</a></li>
<li class="chapter" data-level="5.1.2" data-path="distributed-systems.html"><a href="distributed-systems.html#mapper"><i class="fa fa-check"></i><b>5.1.2</b> Mapper</a></li>
<li class="chapter" data-level="5.1.3" data-path="distributed-systems.html"><a href="distributed-systems.html#reducer"><i class="fa fa-check"></i><b>5.1.3</b> Reducer</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="distributed-systems.html"><a href="distributed-systems.html#hadoop"><i class="fa fa-check"></i><b>5.2</b> Hadoop</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="distributed-systems.html"><a href="distributed-systems.html#hadoop-word-count-example"><i class="fa fa-check"></i><b>5.2.1</b> Hadoop word count example</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="distributed-systems.html"><a href="distributed-systems.html#spark"><i class="fa fa-check"></i><b>5.3</b> Spark</a></li>
<li class="chapter" data-level="5.4" data-path="distributed-systems.html"><a href="distributed-systems.html#spark-with-r"><i class="fa fa-check"></i><b>5.4</b> Spark with R</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="distributed-systems.html"><a href="distributed-systems.html#data-import-and-summary-statistics"><i class="fa fa-check"></i><b>5.4.1</b> Data import and summary statistics</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="distributed-systems.html"><a href="distributed-systems.html#spark-with-sql"><i class="fa fa-check"></i><b>5.5</b> Spark with SQL</a></li>
<li class="chapter" data-level="5.6" data-path="distributed-systems.html"><a href="distributed-systems.html#spark-with-r-sql"><i class="fa fa-check"></i><b>5.6</b> Spark with R + SQL</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="cloud-computing.html"><a href="cloud-computing.html"><i class="fa fa-check"></i><b>6</b> Cloud Computing</a>
<ul>
<li class="chapter" data-level="6.1" data-path="cloud-computing.html"><a href="cloud-computing.html#scaling-up-with-aws-ec2-and-rrstudio"><i class="fa fa-check"></i><b>6.1</b> Scaling up with AWS EC2 and R/RStudio</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="cloud-computing.html"><a href="cloud-computing.html#parallelization-with-an-ec2-instance"><i class="fa fa-check"></i><b>6.1.1</b> Parallelization with an EC2 instance</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="cloud-computing.html"><a href="cloud-computing.html#ec2-with-rstudio-and-gpus"><i class="fa fa-check"></i><b>6.2</b> EC2 with RStudio and GPUs</a></li>
<li class="chapter" data-level="6.3" data-path="cloud-computing.html"><a href="cloud-computing.html#gpus-on-google-colab"><i class="fa fa-check"></i><b>6.3</b> GPUs on Google Colab</a></li>
<li class="chapter" data-level="6.4" data-path="cloud-computing.html"><a href="cloud-computing.html#aws-emr-mapreduce-in-the-cloud"><i class="fa fa-check"></i><b>6.4</b> AWS EMR: MapReduce in the cloud</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data-collection-and-data-storage.html"><a href="data-collection-and-data-storage.html"><i class="fa fa-check"></i><b>7</b> Data Collection and Data Storage</a>
<ul>
<li class="chapter" data-level="7.1" data-path="data-collection-and-data-storage.html"><a href="data-collection-and-data-storage.html#gathering-and-compilation-of-raw-data"><i class="fa fa-check"></i><b>7.1</b> Gathering and compilation of raw data</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="data-collection-and-data-storage.html"><a href="data-collection-and-data-storage.html#nyc-taxi-data"><i class="fa fa-check"></i><b>7.1.1</b> NYC taxi data</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="data-collection-and-data-storage.html"><a href="data-collection-and-data-storage.html#data-import-and-memory-allocation"><i class="fa fa-check"></i><b>7.2</b> Data import and memory allocation</a></li>
<li class="chapter" data-level="7.3" data-path="data-collection-and-data-storage.html"><a href="data-collection-and-data-storage.html#efficient-local-data-storage"><i class="fa fa-check"></i><b>7.3</b> Efficient local data storage</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="data-collection-and-data-storage.html"><a href="data-collection-and-data-storage.html#rdbms-basics"><i class="fa fa-check"></i><b>7.3.1</b> RDBMS basics</a></li>
<li class="chapter" data-level="7.3.2" data-path="data-collection-and-data-storage.html"><a href="data-collection-and-data-storage.html#efficient-data-access-indices-and-joins-in-sqlite"><i class="fa fa-check"></i><b>7.3.2</b> Efficient data access: indices and joins in SQLite</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="data-collection-and-data-storage.html"><a href="data-collection-and-data-storage.html#connecting-r-to-rdbms"><i class="fa fa-check"></i><b>7.4</b> Connecting R to RDBMS</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="data-collection-and-data-storage.html"><a href="data-collection-and-data-storage.html#creating-a-new-database-with-rsqlite"><i class="fa fa-check"></i><b>7.4.1</b> Creating a new database with <code>RSQLite</code></a></li>
<li class="chapter" data-level="7.4.2" data-path="data-collection-and-data-storage.html"><a href="data-collection-and-data-storage.html#importing-data"><i class="fa fa-check"></i><b>7.4.2</b> Importing data</a></li>
<li class="chapter" data-level="7.4.3" data-path="data-collection-and-data-storage.html"><a href="data-collection-and-data-storage.html#issue-queries"><i class="fa fa-check"></i><b>7.4.3</b> Issue queries</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="data-collection-and-data-storage.html"><a href="data-collection-and-data-storage.html#cloud-solutions-for-big-data-storage"><i class="fa fa-check"></i><b>7.5</b> Cloud solutions for (big) data storage</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="data-collection-and-data-storage.html"><a href="data-collection-and-data-storage.html#easy-to-use-rdbms-in-the-cloud-aws-rds"><i class="fa fa-check"></i><b>7.5.1</b> Easy-to-use RDBMS in the cloud: AWS RDS</a></li>
<li class="chapter" data-level="7.5.2" data-path="data-collection-and-data-storage.html"><a href="data-collection-and-data-storage.html#database-server-in-the-cloud-mariadb-on-an-ec2-instance"><i class="fa fa-check"></i><b>7.5.2</b> Database server in the cloud: MariaDB on an EC2 instance</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="big-data-cleaning-and-transformation.html"><a href="big-data-cleaning-and-transformation.html"><i class="fa fa-check"></i><b>8</b> Big Data Cleaning and Transformation</a>
<ul>
<li class="chapter" data-level="8.1" data-path="big-data-cleaning-and-transformation.html"><a href="big-data-cleaning-and-transformation.html#out-of-memory-strategies"><i class="fa fa-check"></i><b>8.1</b> ‘Out-of-memory’ strategies</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="big-data-cleaning-and-transformation.html"><a href="big-data-cleaning-and-transformation.html#chunking-data-with-the-ff-package"><i class="fa fa-check"></i><b>8.1.1</b> Chunking data with the <code>ff</code>-package</a></li>
<li class="chapter" data-level="8.1.2" data-path="big-data-cleaning-and-transformation.html"><a href="big-data-cleaning-and-transformation.html#memory-mapping-with-bigmemory"><i class="fa fa-check"></i><b>8.1.2</b> Memory mapping with <code>bigmemory</code></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="big-data-cleaning-and-transformation.html"><a href="big-data-cleaning-and-transformation.html#typical-cleaning-tasks"><i class="fa fa-check"></i><b>8.2</b> Typical cleaning tasks</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="big-data-cleaning-and-transformation.html"><a href="big-data-cleaning-and-transformation.html#data-preparation-with-ff"><i class="fa fa-check"></i><b>8.2.1</b> Data Preparation with <code>ff</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="descriptive-statistics-and-aggregation.html"><a href="descriptive-statistics-and-aggregation.html"><i class="fa fa-check"></i><b>9</b> Descriptive Statistics and Aggregation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="descriptive-statistics-and-aggregation.html"><a href="descriptive-statistics-and-aggregation.html#data-aggregation-the-split-apply-combine-strategy"><i class="fa fa-check"></i><b>9.1</b> Data aggregation: The ‘split-apply-combine’ strategy</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="descriptive-statistics-and-aggregation.html"><a href="descriptive-statistics-and-aggregation.html#data-aggregation-with-chunked-data-files"><i class="fa fa-check"></i><b>9.1.1</b> Data aggregation with chunked data files</a></li>
<li class="chapter" data-level="9.1.2" data-path="descriptive-statistics-and-aggregation.html"><a href="descriptive-statistics-and-aggregation.html#cross-tabulation-of-ff-vectors"><i class="fa fa-check"></i><b>9.1.2</b> Cross-tabulation of <code>ff</code> vectors</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="descriptive-statistics-and-aggregation.html"><a href="descriptive-statistics-and-aggregation.html#high-speed-in-memory-data-aggregation-with-data.table"><i class="fa fa-check"></i><b>9.2</b> High-speed in-memory data aggregation with <code>data.table</code></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="big-data-visualization.html"><a href="big-data-visualization.html"><i class="fa fa-check"></i><b>10</b> (Big) Data Visualization</a>
<ul>
<li class="chapter" data-level="10.1" data-path="big-data-visualization.html"><a href="big-data-visualization.html#data-exploration-with-ggplot2"><i class="fa fa-check"></i><b>10.1</b> Data exploration with <code>ggplot2</code></a></li>
<li class="chapter" data-level="10.2" data-path="big-data-visualization.html"><a href="big-data-visualization.html#excursus-modify-and-create-themes"><i class="fa fa-check"></i><b>10.2</b> Excursus: modify and create themes</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="big-data-visualization.html"><a href="big-data-visualization.html#create-your-own-theme-simple-approach"><i class="fa fa-check"></i><b>10.2.1</b> Create your own theme: simple approach</a></li>
<li class="chapter" data-level="10.2.2" data-path="big-data-visualization.html"><a href="big-data-visualization.html#implementing-actual-themes-as-functions."><i class="fa fa-check"></i><b>10.2.2</b> Implementing actual themes as functions.</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="big-data-visualization.html"><a href="big-data-visualization.html#visualize-time-and-space"><i class="fa fa-check"></i><b>10.3</b> Visualize Time and Space</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="big-data-visualization.html"><a href="big-data-visualization.html#preparations"><i class="fa fa-check"></i><b>10.3.1</b> Preparations</a></li>
<li class="chapter" data-level="10.3.2" data-path="big-data-visualization.html"><a href="big-data-visualization.html#pick-up-and-drop-off-locations"><i class="fa fa-check"></i><b>10.3.2</b> Pick-up and drop-off locations</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="big-data-visualization.html"><a href="big-data-visualization.html#excursus-change-color-schemes"><i class="fa fa-check"></i><b>10.4</b> Excursus: change color schemes</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="bottle-necks-in-local-big-data-analytics.html"><a href="bottle-necks-in-local-big-data-analytics.html"><i class="fa fa-check"></i><b>11</b> Bottle Necks in Local Big Data Analytics</a>
<ul>
<li class="chapter" data-level="11.1" data-path="bottle-necks-in-local-big-data-analytics.html"><a href="bottle-necks-in-local-big-data-analytics.html#case-study-data-import-and-memory-allocation"><i class="fa fa-check"></i><b>11.1</b> Case study: Data Import and Memory Allocation</a></li>
<li class="chapter" data-level="11.2" data-path="bottle-necks-in-local-big-data-analytics.html"><a href="bottle-necks-in-local-big-data-analytics.html#case-study-loops-memory-and-vectorization"><i class="fa fa-check"></i><b>11.2</b> Case Study: Loops, Memory, and Vectorization</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="bottle-necks-in-local-big-data-analytics.html"><a href="bottle-necks-in-local-big-data-analytics.html#preparation"><i class="fa fa-check"></i><b>11.2.1</b> Preparation</a></li>
<li class="chapter" data-level="11.2.2" data-path="bottle-necks-in-local-big-data-analytics.html"><a href="bottle-necks-in-local-big-data-analytics.html#naïve-approach-ignorant-of-r"><i class="fa fa-check"></i><b>11.2.2</b> Naïve Approach (ignorant of R)</a></li>
<li class="chapter" data-level="11.2.3" data-path="bottle-necks-in-local-big-data-analytics.html"><a href="bottle-necks-in-local-big-data-analytics.html#improvement-1-pre-allocation-of-memory"><i class="fa fa-check"></i><b>11.2.3</b> Improvement 1: Pre-allocation of memory</a></li>
<li class="chapter" data-level="11.2.4" data-path="bottle-necks-in-local-big-data-analytics.html"><a href="bottle-necks-in-local-big-data-analytics.html#improvement-2-exploit-vectorization"><i class="fa fa-check"></i><b>11.2.4</b> Improvement 2: Exploit vectorization</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="bottle-necks-in-local-big-data-analytics.html"><a href="bottle-necks-in-local-big-data-analytics.html#case-study-bootstrapping-and-parallel-processing"><i class="fa fa-check"></i><b>11.3</b> Case study: Bootstrapping and Parallel Processing</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="bottle-necks-in-local-big-data-analytics.html"><a href="bottle-necks-in-local-big-data-analytics.html#parallelization-with-an-ec2-instance-1"><i class="fa fa-check"></i><b>11.3.1</b> Parallelization with an EC2 instance</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="bottle-necks-in-local-big-data-analytics.html"><a href="bottle-necks-in-local-big-data-analytics.html#case-study-efficient-fixed-effects-estimation"><i class="fa fa-check"></i><b>11.4</b> Case Study: Efficient Fixed Effects Estimation</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="gpus-and-machine-learning.html"><a href="gpus-and-machine-learning.html"><i class="fa fa-check"></i><b>12</b> GPUs and Machine Learning</a>
<ul>
<li class="chapter" data-level="12.1" data-path="gpus-and-machine-learning.html"><a href="gpus-and-machine-learning.html#tensorflowkeras-example-predict-housing-prices"><i class="fa fa-check"></i><b>12.1</b> Tensorflow/Keras example: predict housing prices</a></li>
<li class="chapter" data-level="12.2" data-path="gpus-and-machine-learning.html"><a href="gpus-and-machine-learning.html#data-preparation-1"><i class="fa fa-check"></i><b>12.2</b> Data preparation</a></li>
<li class="chapter" data-level="12.3" data-path="gpus-and-machine-learning.html"><a href="gpus-and-machine-learning.html#model-specification"><i class="fa fa-check"></i><b>12.3</b> Model specification</a></li>
<li class="chapter" data-level="12.4" data-path="gpus-and-machine-learning.html"><a href="gpus-and-machine-learning.html#training-and-prediction"><i class="fa fa-check"></i><b>12.4</b> Training and prediction</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="gpus-and-machine-learning.html"><a href="gpus-and-machine-learning.html#a-word-of-caution"><i class="fa fa-check"></i><b>12.4.1</b> A word of caution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="applied-econometrics-with-spark.html"><a href="applied-econometrics-with-spark.html"><i class="fa fa-check"></i><b>13</b> Applied Econometrics with Spark</a>
<ul>
<li class="chapter" data-level="13.1" data-path="applied-econometrics-with-spark.html"><a href="applied-econometrics-with-spark.html#simple-regression-analysis"><i class="fa fa-check"></i><b>13.1</b> Simple regression analysis</a></li>
<li class="chapter" data-level="13.2" data-path="applied-econometrics-with-spark.html"><a href="applied-econometrics-with-spark.html#machine-learning-for-classification"><i class="fa fa-check"></i><b>13.2</b> Machine learning for classification</a></li>
<li class="chapter" data-level="13.3" data-path="applied-econometrics-with-spark.html"><a href="applied-econometrics-with-spark.html#building-machine-learning-pipelines-with-r-and-spark"><i class="fa fa-check"></i><b>13.3</b> Building Machine Learning Pipelines with R and Spark</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="applied-econometrics-with-spark.html"><a href="applied-econometrics-with-spark.html#set-up-and-data-import"><i class="fa fa-check"></i><b>13.3.1</b> Set up and data import</a></li>
<li class="chapter" data-level="13.3.2" data-path="applied-econometrics-with-spark.html"><a href="applied-econometrics-with-spark.html#building-the-pipeline"><i class="fa fa-check"></i><b>13.3.2</b> Building the pipeline</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="applied-econometrics-with-spark.html"><a href="applied-econometrics-with-spark.html#text-analysis-with-spark"><i class="fa fa-check"></i><b>13.4</b> Text analysis with Spark</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="appendix-a.html"><a href="appendix-a.html"><i class="fa fa-check"></i><b>A</b> Appendix A</a>
<ul>
<li class="chapter" data-level="A.1" data-path="appendix-a.html"><a href="appendix-a.html#github"><i class="fa fa-check"></i><b>A.1</b> GitHub</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="appendix-a.html"><a href="appendix-a.html#initiate-a-new-repository"><i class="fa fa-check"></i><b>A.1.1</b> Initiate a new repository</a></li>
<li class="chapter" data-level="A.1.2" data-path="appendix-a.html"><a href="appendix-a.html#clone-this-courses-repository"><i class="fa fa-check"></i><b>A.1.2</b> Clone this course’s repository</a></li>
<li class="chapter" data-level="A.1.3" data-path="appendix-a.html"><a href="appendix-a.html#fork-this-courses-repository"><i class="fa fa-check"></i><b>A.1.3</b> Fork this course’s repository</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="appendix-b.html"><a href="appendix-b.html"><i class="fa fa-check"></i><b>B</b> Appendix B</a>
<ul>
<li class="chapter" data-level="B.0.1" data-path="appendix-b.html"><a href="appendix-b.html#data-types-and-memorystorage"><i class="fa fa-check"></i><b>B.0.1</b> Data types and memory/storage</a></li>
<li class="chapter" data-level="B.0.2" data-path="appendix-b.html"><a href="appendix-b.html#data-structures"><i class="fa fa-check"></i><b>B.0.2</b> Data structures</a></li>
<li class="chapter" data-level="B.0.3" data-path="appendix-b.html"><a href="appendix-b.html#vectors-vs-factors-in-r"><i class="fa fa-check"></i><b>B.0.3</b> Vectors vs Factors in R</a></li>
<li class="chapter" data-level="B.0.4" data-path="appendix-b.html"><a href="appendix-b.html#r-tools-to-investigate-structures-and-types"><i class="fa fa-check"></i><b>B.0.4</b> R-tools to investigate structures and types</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="appendix-c.html"><a href="appendix-c.html"><i class="fa fa-check"></i><b>C</b> Appendix C</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://umatter.github.io" target="blank">umatter.github.io</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Big Data Analytics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="big-data-econometrics" class="section level1" number="2">
<h1><span class="header-section-number">Chapter 2</span> Big Data Econometrics</h1>
<p>Econometrics in the field of Big Data Analytics can be broadly categorized in two domains: techniques/estimators to address <em>big P</em>-problems and techniques/estimators to address <em>big N</em> problems. While this book presupposes some knowledge in at least one of these domains and mainly focuses on on aspects of Big Data Analytics that precede the estimation of econometric models, it is useful to set the stage for the rest of the chapters with two practical examples concerning <em>big P</em> and <em>big N</em> econometric methods.</p>
<div id="a-practical-big-p-problem" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> A practical <em>big P</em> problem</h2>
<p>Due to the abundance of digital data on all kind of human activities, empirical economists as well as business analysts are increasingly confronted with high-dimensional data (many signals, many variables). While having a lot of variables to work with sounds kind of like a good thing, it introduces new problems for coming up with useful predictive models. In the extreme case of having more variables in the model than observations, traditional methods cannot be used at all. In the less extreme case of just having dozens or hundreds of variables in a model (and plenty of observations) we risk to “falsely” discover seemingly influential variables and consequently come up with a model with potentially very misleading out-of-sample predictions. Thus, how can we find a reasonable model?<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></p>
<p>Let’s look at a real-life example. Suppose you work for Google’s e-commerce platform <a href="https://shop.googlemerchandisestore.com">www.googlemerchandiseshop.com</a> and you are in charge of predicting purchases (i.e., a user is actually buying something from your store in a given session) based on user and browser-session characteristics.<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a> The dependent variable <code>purchase</code> is an indicator equal to <code>1</code> if the corresponding shop visit lead to a purchase and equal to <code>0</code> otherwise. All other variables contain information about the user and the session (where is the user located? which browser is she using? etc.). As the dependent variable is binary, we will use in a first step a simple logit model, in which we use the origins of the store visitors (how did a visitor end up in the shop) as explanatory variables. Note that many of these variables are categorical and the model matrix thus contains a lot of dummies. The plan in this (intentionally naive) first approach is to simply add a lot of explanatory variables to the model, run logit, and then select the variables with statistically significant coefficient estimates as the final predictive model.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="big-data-econometrics.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import/inspect data</span></span>
<span id="cb1-2"><a href="big-data-econometrics.html#cb1-2" aria-hidden="true" tabindex="-1"></a>ga <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/ga.csv&quot;</span>)</span>
<span id="cb1-3"><a href="big-data-econometrics.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ga)</span></code></pre></div>
<pre><code>##   visits   source browser isMobile          city
## 1      1   google  Chrome     TRUE      San Jose
## 2      1 (direct)    Edge    FALSE     Charlotte
## 3      1 (direct)  Safari     TRUE San Francisco
## 4      1 (direct)  Safari     TRUE   Los Angeles
## 5      1 (direct)  Chrome    FALSE       Chicago
## 6      1 (direct)  Chrome    FALSE     Sunnyvale
##         country channelGrouping purchase
## 1 United States         (Other)        1
## 2 United States          Direct        1
## 3 United States          Direct        1
## 4 United States          Direct        1
## 5 United States          Direct        1
## 6 United States          Direct        1</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="big-data-econometrics.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create model matrix (dummy vars)</span></span>
<span id="cb3-2"><a href="big-data-econometrics.html#cb3-2" aria-hidden="true" tabindex="-1"></a>mm <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ga<span class="sc">$</span>purchase, <span class="fu">model.matrix</span>(purchase<span class="sc">~</span>source, <span class="at">data=</span>ga,)[,<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb3-3"><a href="big-data-econometrics.html#cb3-3" aria-hidden="true" tabindex="-1"></a>mm_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(mm) </span>
<span id="cb3-4"><a href="big-data-econometrics.html#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># clean variable names</span></span>
<span id="cb3-5"><a href="big-data-econometrics.html#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mm_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;purchase&quot;</span>, <span class="fu">gsub</span>(<span class="st">&quot;source&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">names</span>(mm_df)[<span class="sc">-</span><span class="dv">1</span>]))</span>
<span id="cb3-6"><a href="big-data-econometrics.html#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="big-data-econometrics.html#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># run logit</span></span>
<span id="cb3-8"><a href="big-data-econometrics.html#cb3-8" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(purchase <span class="sc">~</span> .,</span>
<span id="cb3-9"><a href="big-data-econometrics.html#cb3-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">data=</span>mm_df, <span class="at">family=</span>binomial)</span></code></pre></div>
<p>Now we can perform the t-tests and filter out the “relevant” variables.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="big-data-econometrics.html#cb4-1" aria-hidden="true" tabindex="-1"></a>model1_sum <span class="ot">&lt;-</span> <span class="fu">summary</span>(model1)</span>
<span id="cb4-2"><a href="big-data-econometrics.html#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="big-data-econometrics.html#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># select &quot;significant&quot; variables for final model</span></span>
<span id="cb4-4"><a href="big-data-econometrics.html#cb4-4" aria-hidden="true" tabindex="-1"></a>pvalues <span class="ot">&lt;-</span> model1_sum<span class="sc">$</span>coefficients[,<span class="st">&quot;Pr(&gt;|z|)&quot;</span>]</span>
<span id="cb4-5"><a href="big-data-econometrics.html#cb4-5" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">names</span>(pvalues[<span class="fu">which</span>(pvalues<span class="sc">&lt;</span><span class="fl">0.05</span>)][<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb4-6"><a href="big-data-econometrics.html#cb4-6" aria-hidden="true" tabindex="-1"></a>vars</span></code></pre></div>
<pre><code>##  [1] &quot;bing&quot;                   
##  [2] &quot;dfa&quot;                    
##  [3] &quot;docs.google.com&quot;        
##  [4] &quot;facebook.com&quot;           
##  [5] &quot;google&quot;                 
##  [6] &quot;google.com&quot;             
##  [7] &quot;m.facebook.com&quot;         
##  [8] &quot;Partners&quot;               
##  [9] &quot;quora.com&quot;              
## [10] &quot;siliconvalley.about.com&quot;
## [11] &quot;sites.google.com&quot;       
## [12] &quot;t.co&quot;                   
## [13] &quot;youtube.com&quot;</code></pre>
<p>Finally, we re-estimate our “final” model</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="big-data-econometrics.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># specify and estimate the final model</span></span>
<span id="cb6-2"><a href="big-data-econometrics.html#cb6-2" aria-hidden="true" tabindex="-1"></a>finalmodel <span class="ot">&lt;-</span> <span class="fu">glm</span>(purchase <span class="sc">~</span>.,</span>
<span id="cb6-3"><a href="big-data-econometrics.html#cb6-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> mm_df[, <span class="fu">c</span>(<span class="st">&quot;purchase&quot;</span>, vars)], <span class="at">family =</span> binomial)</span></code></pre></div>
<p>The first problem with this approach is that we should not trust the coefficient t-tests based on which we have selected the covariates too much. The first model model contains 62 explanatory variables (+ the intercept). With that many hypothesis tests, we quite likely reject the NULL of no predictive effect although there is actually no predictive effect. In addition, this approach turns out to be unstable. There might be correlation between some variables in the original set of variables and adding/removing even one variable might substantially affect the predictive power of the model (and the apparent relevance of individual variables). We see this already from the summary of our final model estimate. One of the apparently relevant predictors (<code>dfa</code>) is not at all significant anymore in this specification. Thus, we might be tempted to further change the model, which in turn would again change the apparent relevance of other covariates, etc.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="big-data-econometrics.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(finalmodel)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = purchase ~ ., family = binomial, data = mm_df[, 
##     c(&quot;purchase&quot;, vars)])
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -0.669  -0.669  -0.417  -0.021   4.093  
## 
## Coefficients:
##                         Estimate Std. Error z value
## (Intercept)              -1.3831     0.0146  -94.61
## bing                     -1.4647     0.5145   -2.85
## dfa                      -0.1865     0.1223   -1.53
## docs.google.com          -2.0181     1.0166   -1.99
## facebook.com             -1.1663     0.3287   -3.55
## google                   -1.0149     0.0367  -27.62
## google.com               -2.9607     0.7118   -4.16
## m.facebook.com           -3.6920     1.0032   -3.68
## Partners                 -4.3747     0.5784   -7.56
## quora.com                -3.1277     1.0056   -3.11
## siliconvalley.about.com  -2.2456     0.5851   -3.84
## sites.google.com         -0.5968     0.1863   -3.20
## t.co                     -2.0509     0.7186   -2.85
## youtube.com              -6.9935     0.7065   -9.90
##                         Pr(&gt;|z|)    
## (Intercept)              &lt; 2e-16 ***
## bing                     0.00442 ** 
## dfa                      0.12714    
## docs.google.com          0.04714 *  
## facebook.com             0.00039 ***
## google                   &lt; 2e-16 ***
## google.com               3.2e-05 ***
## m.facebook.com           0.00023 ***
## Partners                 3.9e-14 ***
## quora.com                0.00187 ** 
## siliconvalley.about.com  0.00012 ***
## sites.google.com         0.00136 ** 
## t.co                     0.00432 ** 
## youtube.com              &lt; 2e-16 ***
## ---
## Signif. codes:  
## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 40908  on 51934  degrees of freedom
## Residual deviance: 36783  on 51921  degrees of freedom
## AIC: 36811
## 
## Number of Fisher Scoring iterations: 10</code></pre>
<p>An alternative approach would be to estimate models based on all possible combinations of covariates and then use that sequence of models to select the final model based on some out-of-sample prediction performance measure. Clearly such an approach would take a long time to compute.</p>
<p>Instead, the <em>lasso estimator</em> provides a convenient and efficient way to get a sequence of candidate model. The key idea behind the lasso is to penalize model complexity (the cause for instability) during the estimation procedure.<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a> In a second step, we can then select a final model from the sequence of candidate models based on, for example, “out-of-sample” prediction in a k-fold cross validation.</p>
<p>The <code>gamlr</code> package provides both parts of this procedure (lasso for the sequence of candidate models, and selection of “best” model based on k-fold CV).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="big-data-econometrics.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb9-2"><a href="big-data-econometrics.html#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gamlr)</span>
<span id="cb9-3"><a href="big-data-econometrics.html#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="big-data-econometrics.html#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create model matrix</span></span>
<span id="cb9-5"><a href="big-data-econometrics.html#cb9-5" aria-hidden="true" tabindex="-1"></a>mm <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(purchase<span class="sc">~</span>source, <span class="at">data =</span> ga)</span></code></pre></div>
<p>In cases with both many observations and many candidate explanatory variables, the model matrix might get very large. Even just computing the model matrix might be a computational burden, as we might run out of memory to hold the model matrix object. If this large model matrix is sparse (i.e, has a lot of <code>0</code>-entries) there is an alternative way to store it in an R object more memory efficient.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="big-data-econometrics.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create the sparse model matrix</span></span>
<span id="cb10-2"><a href="big-data-econometrics.html#cb10-2" aria-hidden="true" tabindex="-1"></a>mm_sparse <span class="ot">&lt;-</span> <span class="fu">sparse.model.matrix</span>(purchase<span class="sc">~</span>source, <span class="at">data =</span> ga)</span>
<span id="cb10-3"><a href="big-data-econometrics.html#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the sparse representation needs less than 15% of the memory needed for </span></span>
<span id="cb10-4"><a href="big-data-econometrics.html#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># the standard matrix representation in this case:</span></span>
<span id="cb10-5"><a href="big-data-econometrics.html#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(<span class="fu">object.size</span>(mm_sparse)<span class="sc">/</span><span class="fu">object.size</span>(mm))</span></code></pre></div>
<pre><code>## [1] 0.1329</code></pre>
<p>Finally, we run the lasso estimation with K-fold cross-validation.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="big-data-econometrics.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run K-fold cross-validation lasso</span></span>
<span id="cb12-2"><a href="big-data-econometrics.html#cb12-2" aria-hidden="true" tabindex="-1"></a>cvpurchase <span class="ot">&lt;-</span> <span class="fu">cv.gamlr</span>(mm, ga<span class="sc">$</span>purchase, <span class="at">family=</span><span class="st">&quot;binomial&quot;</span>)</span></code></pre></div>
<p>We then can illustrate the performance of the selected final model, for example, with a ROC curve.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="big-data-econometrics.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb13-2"><a href="big-data-econometrics.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PRROC)</span>
<span id="cb13-3"><a href="big-data-econometrics.html#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="big-data-econometrics.html#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># use &quot;best&quot; model for prediction </span></span>
<span id="cb13-5"><a href="big-data-econometrics.html#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># (model selection based on average OSS deviance, here CV1se rule</span></span>
<span id="cb13-6"><a href="big-data-econometrics.html#cb13-6" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(cvpurchase<span class="sc">$</span>gamlr, mm, <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb13-7"><a href="big-data-econometrics.html#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="big-data-econometrics.html#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># compute tpr, fpr, plot ROC</span></span>
<span id="cb13-9"><a href="big-data-econometrics.html#cb13-9" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">roc.curve</span>(<span class="at">scores.class0 =</span> pred,</span>
<span id="cb13-10"><a href="big-data-econometrics.html#cb13-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">weights.class0=</span>ga<span class="sc">$</span>purchase,</span>
<span id="cb13-11"><a href="big-data-econometrics.html#cb13-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">curve=</span><span class="cn">TRUE</span>)</span>
<span id="cb13-12"><a href="big-data-econometrics.html#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(comparison)</span></code></pre></div>
<p><img src="bigdata_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Hence, econometrics techniques such as the lasso help deal with big P problems by providing reasonable ways to select a good predictive model (in other words, decide which of the many variables should be included).</p>
</div>
<div id="a-practical-big-n-problem" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> A practical <em>big N</em> problem</h2>
<p>Big N problems are situations in which we know what type of model we want to use but the <em>number of observations</em> is too big to run the estimation (computer crashes or slows down a lot). The simplest statistical solution to such a problem is usually to just estimate the model based on a smaller sample. However, we might not want to do that for other reasons (see introduction above). As an illustration of how an alternative statistical procedure can speed up the analysis of big N datasets, we look at a procedure to estimate linear models when the classical OLS estimator is computationally too demanding when analyzing large datasets: The <em>Uluru</em> algorithm <span class="citation">(<a href="references.html#ref-dhillon_2013" role="doc-biblioref">Dhillon et al. 2013</a>)</span>.</p>
<div id="ols-as-a-point-of-reference" class="section level3" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> OLS as a point of reference</h3>
<p>Recall the OLS estimator in matrix notation, given the linear model <span class="math inline">\(\mathbf{y}=\mathbf{X}\beta + \epsilon\)</span>:</p>
<p><span class="math inline">\(\hat{\beta}_{OLS} = (\mathbf{X}^\intercal\mathbf{X})^{-1}\mathbf{X}^{\intercal}\mathbf{y}\)</span>.</p>
<p>In order to compute <span class="math inline">\(\hat{\beta}_{OLS}\)</span>, we have to compute <span class="math inline">\((\mathbf{X}^\intercal\mathbf{X})^{-1}\)</span>, which implies a computationally expensive matrix inversion.<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a> If our data set is large, <span class="math inline">\(\mathbf{X}\)</span> is large and the inversion can take up a lot of computation time. Moreover, the inversion and matrix multiplication to get <span class="math inline">\(\hat{\beta}_{OLS}\)</span> needs a lot of memory. In practice, it might well be that the estimation of a linear model via OLS with the standard approach in R (<code>lm()</code>) brings a computer to its knees, as there is not enough RAM available.</p>
<p>To further illustrate the point, we implement the OLS estimator in R.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="big-data-econometrics.html#cb14-1" aria-hidden="true" tabindex="-1"></a>beta_ols <span class="ot">&lt;-</span> </span>
<span id="cb14-2"><a href="big-data-econometrics.html#cb14-2" aria-hidden="true" tabindex="-1"></a>     <span class="cf">function</span>(X, y) {</span>
<span id="cb14-3"><a href="big-data-econometrics.html#cb14-3" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb14-4"><a href="big-data-econometrics.html#cb14-4" aria-hidden="true" tabindex="-1"></a>          <span class="co"># compute cross products and inverse</span></span>
<span id="cb14-5"><a href="big-data-econometrics.html#cb14-5" aria-hidden="true" tabindex="-1"></a>          XXi <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">crossprod</span>(X,X))</span>
<span id="cb14-6"><a href="big-data-econometrics.html#cb14-6" aria-hidden="true" tabindex="-1"></a>          Xy <span class="ot">&lt;-</span> <span class="fu">crossprod</span>(X, y) </span>
<span id="cb14-7"><a href="big-data-econometrics.html#cb14-7" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb14-8"><a href="big-data-econometrics.html#cb14-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">return</span>( XXi  <span class="sc">%*%</span> Xy )</span>
<span id="cb14-9"><a href="big-data-econometrics.html#cb14-9" aria-hidden="true" tabindex="-1"></a>     }</span></code></pre></div>
<p>Now, we will test our OLS estimator function with a few (pseudo) random numbers in a Monte Carlo study. First, we set the sample size parameters <code>n</code> (how many observations shall our pseudo sample have?) and <code>p</code> (how many variables shall describe these observations?) and initiate the data set <code>X</code>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="big-data-econometrics.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set parameter values</span></span>
<span id="cb15-2"><a href="big-data-econometrics.html#cb15-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000000</span></span>
<span id="cb15-3"><a href="big-data-econometrics.html#cb15-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">4</span> </span>
<span id="cb15-4"><a href="big-data-econometrics.html#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="big-data-econometrics.html#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate sample based on Monte Carlo</span></span>
<span id="cb15-6"><a href="big-data-econometrics.html#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># generate a design matrix (~ our &#39;dataset&#39;) with four variables and 10000 observations</span></span>
<span id="cb15-7"><a href="big-data-econometrics.html#cb15-7" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n<span class="sc">*</span>p, <span class="at">mean =</span> <span class="dv">10</span>), <span class="at">ncol =</span> p)</span>
<span id="cb15-8"><a href="big-data-econometrics.html#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># add column for intercept</span></span>
<span id="cb15-9"><a href="big-data-econometrics.html#cb15-9" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="dv">1</span>, n), X)</span></code></pre></div>
<p>Now we define how the real linear model looks like that we have in mind and compute the output <code>y</code> of this model, given the input <code>X</code>.<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="big-data-econometrics.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MC model</span></span>
<span id="cb16-2"><a href="big-data-econometrics.html#cb16-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">1.5</span><span class="sc">*</span>X[,<span class="dv">2</span>] <span class="sc">+</span> <span class="dv">4</span><span class="sc">*</span>X[,<span class="dv">3</span>] <span class="sc">-</span> <span class="fl">3.5</span><span class="sc">*</span>X[,<span class="dv">4</span>] <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>X[,<span class="dv">5</span>] <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span></code></pre></div>
<p>Finally, we test our <code>beta_ols</code> function.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="big-data-econometrics.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># apply the ols estimator</span></span>
<span id="cb17-2"><a href="big-data-econometrics.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">beta_ols</span>(X, y)</span></code></pre></div>
<pre><code>##         [,1]
## [1,]  1.9956
## [2,]  1.5000
## [3,]  4.0000
## [4,] -3.4999
## [5,]  0.5004</code></pre>
</div>
<div id="the-uluru-algorithm-as-an-alternative-to-ols" class="section level3" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> The Uluru algorithm as an alternative to OLS</h3>
<p>Following <span class="citation"><a href="references.html#ref-dhillon_2013" role="doc-biblioref">Dhillon et al.</a> (<a href="references.html#ref-dhillon_2013" role="doc-biblioref">2013</a>)</span>, we implement a procedure to compute <span class="math inline">\(\hat{\beta}_{Uluru}\)</span>:</p>
<p><span class="math display">\[\hat{\beta}_{Uluru}=\hat{\beta}_{FS} + \hat{\beta}_{correct}\]</span>, where
<span class="math display">\[\hat{\beta}_{FS} = (\mathbf{X}_{subs}^\intercal\mathbf{X}_{subs})^{-1}\mathbf{X}_{subs}^{\intercal}\mathbf{y}_{subs}\]</span>, and
<span class="math display">\[\hat{\beta}_{correct}= \frac{n_{subs}}{n_{rem}} \cdot (\mathbf{X}_{subs}^\intercal\mathbf{X}_{subs})^{-1} \mathbf{X}_{rem}^{\intercal}\mathbf{R}_{rem}\]</span>, and
<span class="math display">\[\mathbf{R}_{rem} = \mathbf{Y}_{rem} - \mathbf{X}_{rem}  \cdot \hat{\beta}_{FS}\]</span>.</p>
<p>The key idea behind this is that the computational bottleneck of the OLS estimator, the cross product and matrix inversion,<span class="math inline">\((\mathbf{X}^\intercal\mathbf{X})^{-1}\)</span>, is only computed on a sub-sample (<span class="math inline">\(X_{subs}\)</span>, etc.), not the entire data set. However, the remainder of the data set is also taken into consideration (in order to correct a bias arising from the sub-sampling). Again, we implement the estimator in R to further illustrate this point.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="big-data-econometrics.html#cb19-1" aria-hidden="true" tabindex="-1"></a>beta_uluru <span class="ot">&lt;-</span></span>
<span id="cb19-2"><a href="big-data-econometrics.html#cb19-2" aria-hidden="true" tabindex="-1"></a>     <span class="cf">function</span>(X_subs, y_subs, X_rem, y_rem) {</span>
<span id="cb19-3"><a href="big-data-econometrics.html#cb19-3" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb19-4"><a href="big-data-econometrics.html#cb19-4" aria-hidden="true" tabindex="-1"></a>          <span class="co"># compute beta_fs (this is simply OLS applied to the subsample)</span></span>
<span id="cb19-5"><a href="big-data-econometrics.html#cb19-5" aria-hidden="true" tabindex="-1"></a>          XXi_subs <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">crossprod</span>(X_subs, X_subs))</span>
<span id="cb19-6"><a href="big-data-econometrics.html#cb19-6" aria-hidden="true" tabindex="-1"></a>          Xy_subs <span class="ot">&lt;-</span> <span class="fu">crossprod</span>(X_subs, y_subs)</span>
<span id="cb19-7"><a href="big-data-econometrics.html#cb19-7" aria-hidden="true" tabindex="-1"></a>          b_fs <span class="ot">&lt;-</span> XXi_subs  <span class="sc">%*%</span> Xy_subs</span>
<span id="cb19-8"><a href="big-data-econometrics.html#cb19-8" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb19-9"><a href="big-data-econometrics.html#cb19-9" aria-hidden="true" tabindex="-1"></a>          <span class="co"># compute \mathbf{R}_{rem}</span></span>
<span id="cb19-10"><a href="big-data-econometrics.html#cb19-10" aria-hidden="true" tabindex="-1"></a>          R_rem <span class="ot">&lt;-</span> y_rem <span class="sc">-</span> X_rem <span class="sc">%*%</span> b_fs</span>
<span id="cb19-11"><a href="big-data-econometrics.html#cb19-11" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb19-12"><a href="big-data-econometrics.html#cb19-12" aria-hidden="true" tabindex="-1"></a>          <span class="co"># compute \hat{\beta}_{correct}</span></span>
<span id="cb19-13"><a href="big-data-econometrics.html#cb19-13" aria-hidden="true" tabindex="-1"></a>          b_correct <span class="ot">&lt;-</span> (<span class="fu">nrow</span>(X_subs)<span class="sc">/</span>(<span class="fu">nrow</span>(X_rem))) <span class="sc">*</span> XXi_subs <span class="sc">%*%</span> <span class="fu">crossprod</span>(X_rem, R_rem)</span>
<span id="cb19-14"><a href="big-data-econometrics.html#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="big-data-econometrics.html#cb19-15" aria-hidden="true" tabindex="-1"></a>          <span class="co"># beta uluru       </span></span>
<span id="cb19-16"><a href="big-data-econometrics.html#cb19-16" aria-hidden="true" tabindex="-1"></a>          <span class="fu">return</span>(b_fs <span class="sc">+</span> b_correct)</span>
<span id="cb19-17"><a href="big-data-econometrics.html#cb19-17" aria-hidden="true" tabindex="-1"></a>     }</span></code></pre></div>
<p>Test it with the same input as above:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="big-data-econometrics.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set size of subsample</span></span>
<span id="cb20-2"><a href="big-data-econometrics.html#cb20-2" aria-hidden="true" tabindex="-1"></a>n_subs <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb20-3"><a href="big-data-econometrics.html#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># select subsample and remainder</span></span>
<span id="cb20-4"><a href="big-data-econometrics.html#cb20-4" aria-hidden="true" tabindex="-1"></a>n_obs <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X)</span>
<span id="cb20-5"><a href="big-data-econometrics.html#cb20-5" aria-hidden="true" tabindex="-1"></a>X_subs <span class="ot">&lt;-</span> X[1L<span class="sc">:</span>n_subs,]</span>
<span id="cb20-6"><a href="big-data-econometrics.html#cb20-6" aria-hidden="true" tabindex="-1"></a>y_subs <span class="ot">&lt;-</span> y[1L<span class="sc">:</span>n_subs]</span>
<span id="cb20-7"><a href="big-data-econometrics.html#cb20-7" aria-hidden="true" tabindex="-1"></a>X_rem <span class="ot">&lt;-</span> X[(n_subs<span class="sc">+</span>1L)<span class="sc">:</span>n_obs,]</span>
<span id="cb20-8"><a href="big-data-econometrics.html#cb20-8" aria-hidden="true" tabindex="-1"></a>y_rem <span class="ot">&lt;-</span> y[(n_subs<span class="sc">+</span>1L)<span class="sc">:</span>n_obs]</span>
<span id="cb20-9"><a href="big-data-econometrics.html#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="big-data-econometrics.html#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co"># apply the uluru estimator</span></span>
<span id="cb20-11"><a href="big-data-econometrics.html#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="fu">beta_uluru</span>(X_subs, y_subs, X_rem, y_rem)</span></code></pre></div>
<pre><code>##         [,1]
## [1,]  1.9283
## [2,]  1.5018
## [3,]  4.0040
## [4,] -3.5009
## [5,]  0.5024</code></pre>
<p>This looks quite good already. Let’s have a closer look with a little Monte Carlo study. The aim of the simulation study is to visualize the difference between the classical OLS approach and the <em>Uluru</em> algorithm with regard to bias and time complexity if we increase the sub-sample size in <em>Uluru</em>. For simplicity, we only look at the first estimated coefficient <span class="math inline">\(\beta_{1}\)</span>.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="big-data-econometrics.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define subsamples</span></span>
<span id="cb22-2"><a href="big-data-econometrics.html#cb22-2" aria-hidden="true" tabindex="-1"></a>n_subs_sizes <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1000</span>, <span class="at">to =</span> <span class="dv">500000</span>, <span class="at">by=</span><span class="dv">10000</span>)</span>
<span id="cb22-3"><a href="big-data-econometrics.html#cb22-3" aria-hidden="true" tabindex="-1"></a>n_runs <span class="ot">&lt;-</span> <span class="fu">length</span>(n_subs_sizes)</span>
<span id="cb22-4"><a href="big-data-econometrics.html#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># compute uluru result, stop time</span></span>
<span id="cb22-5"><a href="big-data-econometrics.html#cb22-5" aria-hidden="true" tabindex="-1"></a>mc_results <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n_runs)</span>
<span id="cb22-6"><a href="big-data-econometrics.html#cb22-6" aria-hidden="true" tabindex="-1"></a>mc_times <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n_runs)</span>
<span id="cb22-7"><a href="big-data-econometrics.html#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_runs) {</span>
<span id="cb22-8"><a href="big-data-econometrics.html#cb22-8" aria-hidden="true" tabindex="-1"></a>     <span class="co"># set size of subsample</span></span>
<span id="cb22-9"><a href="big-data-econometrics.html#cb22-9" aria-hidden="true" tabindex="-1"></a>     n_subs <span class="ot">&lt;-</span> n_subs_sizes[i]</span>
<span id="cb22-10"><a href="big-data-econometrics.html#cb22-10" aria-hidden="true" tabindex="-1"></a>     <span class="co"># select subsample and remainder</span></span>
<span id="cb22-11"><a href="big-data-econometrics.html#cb22-11" aria-hidden="true" tabindex="-1"></a>     n_obs <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X)</span>
<span id="cb22-12"><a href="big-data-econometrics.html#cb22-12" aria-hidden="true" tabindex="-1"></a>     X_subs <span class="ot">&lt;-</span> X[1L<span class="sc">:</span>n_subs,]</span>
<span id="cb22-13"><a href="big-data-econometrics.html#cb22-13" aria-hidden="true" tabindex="-1"></a>     y_subs <span class="ot">&lt;-</span> y[1L<span class="sc">:</span>n_subs]</span>
<span id="cb22-14"><a href="big-data-econometrics.html#cb22-14" aria-hidden="true" tabindex="-1"></a>     X_rem <span class="ot">&lt;-</span> X[(n_subs<span class="sc">+</span>1L)<span class="sc">:</span>n_obs,]</span>
<span id="cb22-15"><a href="big-data-econometrics.html#cb22-15" aria-hidden="true" tabindex="-1"></a>     y_rem <span class="ot">&lt;-</span> y[(n_subs<span class="sc">+</span>1L)<span class="sc">:</span>n_obs]</span>
<span id="cb22-16"><a href="big-data-econometrics.html#cb22-16" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb22-17"><a href="big-data-econometrics.html#cb22-17" aria-hidden="true" tabindex="-1"></a>     mc_results[i] <span class="ot">&lt;-</span> <span class="fu">beta_uluru</span>(X_subs, y_subs, X_rem, y_rem)[<span class="dv">2</span>] <span class="co"># the first element is the intercept</span></span>
<span id="cb22-18"><a href="big-data-econometrics.html#cb22-18" aria-hidden="true" tabindex="-1"></a>     mc_times[i] <span class="ot">&lt;-</span> <span class="fu">system.time</span>(<span class="fu">beta_uluru</span>(X_subs, y_subs, X_rem, y_rem))[<span class="dv">3</span>]</span>
<span id="cb22-19"><a href="big-data-econometrics.html#cb22-19" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb22-20"><a href="big-data-econometrics.html#cb22-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-21"><a href="big-data-econometrics.html#cb22-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-22"><a href="big-data-econometrics.html#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="co"># compute ols results and ols time</span></span>
<span id="cb22-23"><a href="big-data-econometrics.html#cb22-23" aria-hidden="true" tabindex="-1"></a>ols_time <span class="ot">&lt;-</span> <span class="fu">system.time</span>(<span class="fu">beta_ols</span>(X, y))</span>
<span id="cb22-24"><a href="big-data-econometrics.html#cb22-24" aria-hidden="true" tabindex="-1"></a>ols_res <span class="ot">&lt;-</span> <span class="fu">beta_ols</span>(X, y)[<span class="dv">2</span>]</span></code></pre></div>
<p>Let’s visualize the comparison with OLS.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="big-data-econometrics.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb23-2"><a href="big-data-econometrics.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb23-3"><a href="big-data-econometrics.html#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="big-data-econometrics.html#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare data to plot</span></span>
<span id="cb23-5"><a href="big-data-econometrics.html#cb23-5" aria-hidden="true" tabindex="-1"></a>plotdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">beta1 =</span> mc_results,</span>
<span id="cb23-6"><a href="big-data-econometrics.html#cb23-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">time_elapsed =</span> mc_times,</span>
<span id="cb23-7"><a href="big-data-econometrics.html#cb23-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">subs_size =</span> n_subs_sizes)</span></code></pre></div>
<p>First, let’s look at the time used estimate the linear model.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="big-data-econometrics.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plotdata, <span class="fu">aes</span>(<span class="at">x =</span> subs_size, <span class="at">y =</span> time_elapsed)) <span class="sc">+</span></span>
<span id="cb24-2"><a href="big-data-econometrics.html#cb24-2" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&quot;darkgreen&quot;</span>) <span class="sc">+</span> </span>
<span id="cb24-3"><a href="big-data-econometrics.html#cb24-3" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> ols_time[<span class="dv">3</span>],</span>
<span id="cb24-4"><a href="big-data-econometrics.html#cb24-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb24-5"><a href="big-data-econometrics.html#cb24-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb24-6"><a href="big-data-econometrics.html#cb24-6" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb24-7"><a href="big-data-econometrics.html#cb24-7" aria-hidden="true" tabindex="-1"></a>     <span class="fu">ylab</span>(<span class="st">&quot;Time elapsed&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-8"><a href="big-data-econometrics.html#cb24-8" aria-hidden="true" tabindex="-1"></a>     <span class="fu">xlab</span>(<span class="st">&quot;Subsample size&quot;</span>)</span></code></pre></div>
<p><img src="bigdata_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>The horizontal red line indicates the computation time for estimation via OLS, the green points indicate the computation time for the estimation via the Ulruru algorithm. Note that even for large sub-samples, the computation time is substantially lower than for OLS.</p>
<p>Finally, let’s have a look at how close the results are to OLS.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="big-data-econometrics.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plotdata, <span class="fu">aes</span>(<span class="at">x =</span> subs_size, <span class="at">y =</span> beta1)) <span class="sc">+</span></span>
<span id="cb25-2"><a href="big-data-econometrics.html#cb25-2" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> ols_res,</span>
<span id="cb25-3"><a href="big-data-econometrics.html#cb25-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb25-4"><a href="big-data-econometrics.html#cb25-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb25-5"><a href="big-data-econometrics.html#cb25-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">1.5</span>,</span>
<span id="cb25-6"><a href="big-data-econometrics.html#cb25-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">&quot;green&quot;</span>,</span>
<span id="cb25-7"><a href="big-data-econometrics.html#cb25-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb25-8"><a href="big-data-econometrics.html#cb25-8" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&quot;darkgreen&quot;</span>) <span class="sc">+</span> </span>
<span id="cb25-9"><a href="big-data-econometrics.html#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="big-data-econometrics.html#cb25-10" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb25-11"><a href="big-data-econometrics.html#cb25-11" aria-hidden="true" tabindex="-1"></a>     <span class="fu">ylab</span>(<span class="st">&quot;Estimated coefficient&quot;</span>) <span class="sc">+</span></span>
<span id="cb25-12"><a href="big-data-econometrics.html#cb25-12" aria-hidden="true" tabindex="-1"></a>     <span class="fu">xlab</span>(<span class="st">&quot;Subsample size&quot;</span>)</span></code></pre></div>
<p><img src="bigdata_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>The horizontal red line indicates the size of the estimated coefficient, when using OLS. The horizontal green line indicates the size of the actual coefficient. The green points indicate the size of the same coefficient estimated by the Uluru algorithm for different sub-sample sizes. Note that even relatively small sub-samples already deliver estimates very close to the OLS estimates.</p>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="4">
<li id="fn4"><p>Note that finding a model with good in-sample prediction performance is trivial when you have a lot of variables, simply adding more variables will improve the performance. However, that will inevitably result in a non-sense model as even highly significant variables might not have any actual predictive power when looking at out-of-sample predictions. Hence, in this kind of exercise we should <em>exclusively focus on out-of-sample predictions</em> when assessing the performance of candidate models.<a href="big-data-econometrics.html#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>We will in fact be working with a real-life Google Analytics data from www.googlemerchandiseshop.com, see here for details about the data set: <a href="https://www.blog.google/products/marketingplatform/analytics/introducing-google-analytics-sample/" class="uri">https://www.blog.google/products/marketingplatform/analytics/introducing-google-analytics-sample/</a>.<a href="big-data-econometrics.html#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>This is done by adding <span class="math inline">\(\lambda\sum_k{|\beta_k|}\)</span> as a ‘cost’ to the optimization problem.<a href="big-data-econometrics.html#fnref6" class="footnote-back">↩︎</a></p></li>
<li id="fn7"><p>The computational complexity of this is larger than <span class="math inline">\(O(n^{2})\)</span>. That is, for an input of size <span class="math inline">\(n\)</span>, the time needed to compute (or the number of operations needed) is <span class="math inline">\(n^2\)</span>.<a href="big-data-econometrics.html#fnref7" class="footnote-back">↩︎</a></p></li>
<li id="fn8"><p>In reality we would not know this, of course. Acting as if we knew the real model is exactly the point of Monte Carlo studies. It allows us to analyze the properties of estimators by simulation.<a href="big-data-econometrics.html#fnref8" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="software-programming-with-big-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 1
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bigdata.pdf", "bigdata.html", "bigdata.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
