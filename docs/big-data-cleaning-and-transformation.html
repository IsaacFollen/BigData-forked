<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Big Data Cleaning and Transformation | Big Data Analytics</title>
  <meta name="description" content="A guide to practical big data analytics in R." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Big Data Cleaning and Transformation | Big Data Analytics" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="img/cover.png" />
  <meta property="og:description" content="A guide to practical big data analytics in R." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Big Data Cleaning and Transformation | Big Data Analytics" />
  
  <meta name="twitter:description" content="A guide to practical big data analytics in R." />
  <meta name="twitter:image" content="img/cover.png" />

<meta name="author" content="Ulrich Matter" />


<meta name="date" content="2022-01-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="advanced-r-programming.html"/>
<link rel="next" href="data-aggregation.html"/>
<script src="libs/header-attrs/header-attrs.js"></script>
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Big Data Analytics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#example-of-computation-time-and-memory-allocation"><i class="fa fa-check"></i><b>1.1</b> Example of Computation Time and Memory Allocation</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introduction.html"><a href="introduction.html#preparation"><i class="fa fa-check"></i><b>1.1.1</b> Preparation</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction.html"><a href="introduction.html#naïve-approach-ignorant-of-r"><i class="fa fa-check"></i><b>1.1.2</b> Naïve Approach (ignorant of R)</a></li>
<li class="chapter" data-level="1.1.3" data-path="introduction.html"><a href="introduction.html#improvement-1-pre-allocation-of-memory"><i class="fa fa-check"></i><b>1.1.3</b> Improvement 1: Pre-allocation of memory</a></li>
<li class="chapter" data-level="1.1.4" data-path="introduction.html"><a href="introduction.html#improvement-2-exploit-vectorization"><i class="fa fa-check"></i><b>1.1.4</b> Improvement 2: Exploit vectorization</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="computing-resources.html"><a href="computing-resources.html"><i class="fa fa-check"></i><b>2</b> Computing Resources</a>
<ul>
<li class="chapter" data-level="2.1" data-path="computing-resources.html"><a href="computing-resources.html#components-of-a-standard-computing-environment"><i class="fa fa-check"></i><b>2.1</b> Components of a standard computing environment</a></li>
<li class="chapter" data-level="2.2" data-path="computing-resources.html"><a href="computing-resources.html#units-of-informationdata-storage"><i class="fa fa-check"></i><b>2.2</b> Units of information/data storage</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="computing-resources.html"><a href="computing-resources.html#example-in-r-data-types-and-information-storage"><i class="fa fa-check"></i><b>2.2.1</b> Example in R: Data types and information storage</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="computing-resources.html"><a href="computing-resources.html#big-data-econometrics"><i class="fa fa-check"></i><b>2.3</b> Big Data econometrics</a></li>
<li class="chapter" data-level="2.4" data-path="computing-resources.html"><a href="computing-resources.html#example-fast-least-squares-regression"><i class="fa fa-check"></i><b>2.4</b> Example: Fast least squares regression</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="computing-resources.html"><a href="computing-resources.html#ols-as-a-point-of-reference"><i class="fa fa-check"></i><b>2.4.1</b> OLS as a point of reference</a></li>
<li class="chapter" data-level="2.4.2" data-path="computing-resources.html"><a href="computing-resources.html#the-uluru-algorithm-as-an-alternative-to-ols"><i class="fa fa-check"></i><b>2.4.2</b> The Uluru algorithm as an alternative to OLS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="resource-allocation.html"><a href="resource-allocation.html"><i class="fa fa-check"></i><b>3</b> Resource allocation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="resource-allocation.html"><a href="resource-allocation.html#case-study-parallel-processing"><i class="fa fa-check"></i><b>3.1</b> Case study: Parallel processing</a></li>
<li class="chapter" data-level="3.2" data-path="resource-allocation.html"><a href="resource-allocation.html#case-study-memory-allocation"><i class="fa fa-check"></i><b>3.2</b> Case study: Memory allocation</a></li>
<li class="chapter" data-level="3.3" data-path="resource-allocation.html"><a href="resource-allocation.html#beyond-memory"><i class="fa fa-check"></i><b>3.3</b> Beyond memory</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="advanced-r-programming.html"><a href="advanced-r-programming.html"><i class="fa fa-check"></i><b>4</b> Advanced R Programming</a>
<ul>
<li class="chapter" data-level="4.1" data-path="advanced-r-programming.html"><a href="advanced-r-programming.html#r-tools-to-investigate-performanceresource-allocation"><i class="fa fa-check"></i><b>4.1</b> R-tools to investigate performance/resource allocation</a></li>
<li class="chapter" data-level="4.2" data-path="advanced-r-programming.html"><a href="advanced-r-programming.html#r-tools-to-investigate-structures-and-types"><i class="fa fa-check"></i><b>4.2</b> R-tools to investigate structures and types</a></li>
<li class="chapter" data-level="4.3" data-path="advanced-r-programming.html"><a href="advanced-r-programming.html#data-types-and-memorystorage"><i class="fa fa-check"></i><b>4.3</b> Data types and memory/storage</a></li>
<li class="chapter" data-level="4.4" data-path="advanced-r-programming.html"><a href="advanced-r-programming.html#data-structures"><i class="fa fa-check"></i><b>4.4</b> Data structures</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="advanced-r-programming.html"><a href="advanced-r-programming.html#vectors-vs-factors-in-r"><i class="fa fa-check"></i><b>4.4.1</b> Vectors vs Factors in R</a></li>
<li class="chapter" data-level="4.4.2" data-path="advanced-r-programming.html"><a href="advanced-r-programming.html#matricesarrays"><i class="fa fa-check"></i><b>4.4.2</b> Matrices/Arrays</a></li>
<li class="chapter" data-level="4.4.3" data-path="advanced-r-programming.html"><a href="advanced-r-programming.html#data-frames-tibbles-and-data-tables"><i class="fa fa-check"></i><b>4.4.3</b> Data frames, tibbles, and data tables</a></li>
<li class="chapter" data-level="4.4.4" data-path="advanced-r-programming.html"><a href="advanced-r-programming.html#lists"><i class="fa fa-check"></i><b>4.4.4</b> Lists</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="advanced-r-programming.html"><a href="advanced-r-programming.html#programming-with-big-data-in-r"><i class="fa fa-check"></i><b>4.5</b> Programming with (Big) Data in R</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="advanced-r-programming.html"><a href="advanced-r-programming.html#typical-programming-tasks"><i class="fa fa-check"></i><b>4.5.1</b> Typical Programming Tasks</a></li>
<li class="chapter" data-level="4.5.2" data-path="advanced-r-programming.html"><a href="advanced-r-programming.html#building-blocks-for-programming-with-big-data"><i class="fa fa-check"></i><b>4.5.2</b> Building blocks for programming with big data</a></li>
<li class="chapter" data-level="4.5.3" data-path="advanced-r-programming.html"><a href="advanced-r-programming.html#writing-efficient-code"><i class="fa fa-check"></i><b>4.5.3</b> Writing efficient code</a></li>
<li class="chapter" data-level="4.5.4" data-path="advanced-r-programming.html"><a href="advanced-r-programming.html#r-beyond-r"><i class="fa fa-check"></i><b>4.5.4</b> R, beyond R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="big-data-cleaning-and-transformation.html"><a href="big-data-cleaning-and-transformation.html"><i class="fa fa-check"></i><b>5</b> Big Data Cleaning and Transformation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="big-data-cleaning-and-transformation.html"><a href="big-data-cleaning-and-transformation.html#out-of-memory-strategies"><i class="fa fa-check"></i><b>5.1</b> ‘Out-of-memory’ strategies</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="big-data-cleaning-and-transformation.html"><a href="big-data-cleaning-and-transformation.html#chunking-data-with-the-ff-package"><i class="fa fa-check"></i><b>5.1.1</b> Chunking data with the <code>ff</code>-package</a></li>
<li class="chapter" data-level="5.1.2" data-path="big-data-cleaning-and-transformation.html"><a href="big-data-cleaning-and-transformation.html#memory-mapping-with-bigmemory"><i class="fa fa-check"></i><b>5.1.2</b> Memory mapping with <code>bigmemory</code></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="big-data-cleaning-and-transformation.html"><a href="big-data-cleaning-and-transformation.html#typical-cleaning-tasks"><i class="fa fa-check"></i><b>5.2</b> Typical cleaning tasks</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="big-data-cleaning-and-transformation.html"><a href="big-data-cleaning-and-transformation.html#data-preparation-with-ff"><i class="fa fa-check"></i><b>5.2.1</b> Data Preparation with <code>ff</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-aggregation.html"><a href="data-aggregation.html"><i class="fa fa-check"></i><b>6</b> Data Aggregation</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data-aggregation.html"><a href="data-aggregation.html#data-aggregation-the-split-apply-combine-strategy"><i class="fa fa-check"></i><b>6.1</b> Data aggregation: The ‘split-apply-combine’ strategy</a></li>
<li class="chapter" data-level="6.2" data-path="data-aggregation.html"><a href="data-aggregation.html#data-aggregation-tutorial"><i class="fa fa-check"></i><b>6.2</b> Data aggregation tutorial</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="data-aggregation.html"><a href="data-aggregation.html#gathering-and-compilation-of-all-the-raw-data"><i class="fa fa-check"></i><b>6.2.1</b> Gathering and Compilation of all the raw data</a></li>
<li class="chapter" data-level="6.2.2" data-path="data-aggregation.html"><a href="data-aggregation.html#data-aggregation-with-chunked-data-files"><i class="fa fa-check"></i><b>6.2.2</b> Data aggregation with chunked data files</a></li>
<li class="chapter" data-level="6.2.3" data-path="data-aggregation.html"><a href="data-aggregation.html#high-speed-in-memory-data-aggregation-with-data.table"><i class="fa fa-check"></i><b>6.2.3</b> High-speed in-memory data aggregation with <code>data.table</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data-storage-and-databases.html"><a href="data-storage-and-databases.html"><i class="fa fa-check"></i><b>7</b> Data Storage and Databases</a>
<ul>
<li class="chapter" data-level="7.1" data-path="data-storage-and-databases.html"><a href="data-storage-and-databases.html#big-data-storage"><i class="fa fa-check"></i><b>7.1</b> (Big) Data Storage</a></li>
<li class="chapter" data-level="7.2" data-path="data-storage-and-databases.html"><a href="data-storage-and-databases.html#rdbms-basics"><i class="fa fa-check"></i><b>7.2</b> RDBMS basics</a></li>
<li class="chapter" data-level="7.3" data-path="data-storage-and-databases.html"><a href="data-storage-and-databases.html#getting-started-with-rsqlite"><i class="fa fa-check"></i><b>7.3</b> Getting started with (R)SQLite</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="data-storage-and-databases.html"><a href="data-storage-and-databases.html#first-steps-in-sqlite"><i class="fa fa-check"></i><b>7.3.1</b> First steps in SQLite</a></li>
<li class="chapter" data-level="7.3.2" data-path="data-storage-and-databases.html"><a href="data-storage-and-databases.html#indices-and-joins"><i class="fa fa-check"></i><b>7.3.2</b> Indices and joins</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="data-storage-and-databases.html"><a href="data-storage-and-databases.html#sqlite-from-within-r"><i class="fa fa-check"></i><b>7.4</b> SQLite from within R</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="data-storage-and-databases.html"><a href="data-storage-and-databases.html#creating-a-new-database-with-rsqlite"><i class="fa fa-check"></i><b>7.4.1</b> Creating a new database with <code>RSQLite</code></a></li>
<li class="chapter" data-level="7.4.2" data-path="data-storage-and-databases.html"><a href="data-storage-and-databases.html#importing-data"><i class="fa fa-check"></i><b>7.4.2</b> Importing data</a></li>
<li class="chapter" data-level="7.4.3" data-path="data-storage-and-databases.html"><a href="data-storage-and-databases.html#issue-queries"><i class="fa fa-check"></i><b>7.4.3</b> Issue queries</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="big-data-visualization.html"><a href="big-data-visualization.html"><i class="fa fa-check"></i><b>8</b> (Big) Data Visualization</a>
<ul>
<li class="chapter" data-level="8.1" data-path="big-data-visualization.html"><a href="big-data-visualization.html#data-set"><i class="fa fa-check"></i><b>8.1</b> Data Set</a></li>
<li class="chapter" data-level="8.2" data-path="big-data-visualization.html"><a href="big-data-visualization.html#excursus-modify-and-create-themes"><i class="fa fa-check"></i><b>8.2</b> Excursus: modify and create themes</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="big-data-visualization.html"><a href="big-data-visualization.html#create-your-own-theme-simple-approach"><i class="fa fa-check"></i><b>8.2.1</b> Create your own theme: simple approach</a></li>
<li class="chapter" data-level="8.2.2" data-path="big-data-visualization.html"><a href="big-data-visualization.html#implementing-actual-themes-as-functions."><i class="fa fa-check"></i><b>8.2.2</b> Implementing actual themes as functions.</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="big-data-visualization.html"><a href="big-data-visualization.html#visualize-time-and-space"><i class="fa fa-check"></i><b>8.3</b> Visualize Time and Space</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="big-data-visualization.html"><a href="big-data-visualization.html#preparations"><i class="fa fa-check"></i><b>8.3.1</b> Preparations</a></li>
<li class="chapter" data-level="8.3.2" data-path="big-data-visualization.html"><a href="big-data-visualization.html#pick-up-and-drop-off-locations"><i class="fa fa-check"></i><b>8.3.2</b> Pick-up and drop-off locations</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="big-data-visualization.html"><a href="big-data-visualization.html#excursus-change-color-schemes"><i class="fa fa-check"></i><b>8.4</b> Excursus: change color schemes</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="cloud-services-for-big-data-analytics.html"><a href="cloud-services-for-big-data-analytics.html"><i class="fa fa-check"></i><b>9</b> Cloud Services for Big Data Analytics</a>
<ul>
<li class="chapter" data-level="9.1" data-path="cloud-services-for-big-data-analytics.html"><a href="cloud-services-for-big-data-analytics.html#scaling-up-in-the-cloud"><i class="fa fa-check"></i><b>9.1</b> Scaling up in the Cloud</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="cloud-services-for-big-data-analytics.html"><a href="cloud-services-for-big-data-analytics.html#parallelization-with-an-ec2-instance"><i class="fa fa-check"></i><b>9.1.1</b> Parallelization with an EC2 instance</a></li>
<li class="chapter" data-level="9.1.2" data-path="cloud-services-for-big-data-analytics.html"><a href="cloud-services-for-big-data-analytics.html#mass-storage-mariadb-on-an-ec2-instance"><i class="fa fa-check"></i><b>9.1.2</b> Mass Storage: MariaDB on an EC2 instance</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="cloud-services-for-big-data-analytics.html"><a href="cloud-services-for-big-data-analytics.html#distributed-systemsmapreduce"><i class="fa fa-check"></i><b>9.2</b> Distributed Systems/MapReduce</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="cloud-services-for-big-data-analytics.html"><a href="cloud-services-for-big-data-analytics.html#mapreduce-concept-illustration-in-r"><i class="fa fa-check"></i><b>9.2.1</b> Map/Reduce Concept: Illustration in R</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="cloud-services-for-big-data-analytics.html"><a href="cloud-services-for-big-data-analytics.html#hadoop-word-count"><i class="fa fa-check"></i><b>9.3</b> Hadoop Word Count</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="cloud-services-for-big-data-analytics.html"><a href="cloud-services-for-big-data-analytics.html#install-hadoop-on-ubuntupop_os-linux"><i class="fa fa-check"></i><b>9.3.1</b> Install Hadoop (on Ubuntu/Pop!_OS Linux)</a></li>
<li class="chapter" data-level="9.3.2" data-path="cloud-services-for-big-data-analytics.html"><a href="cloud-services-for-big-data-analytics.html#run-hadoop"><i class="fa fa-check"></i><b>9.3.2</b> Run Hadoop</a></li>
<li class="chapter" data-level="9.3.3" data-path="cloud-services-for-big-data-analytics.html"><a href="cloud-services-for-big-data-analytics.html#run-example"><i class="fa fa-check"></i><b>9.3.3</b> Run example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="gpus-for-scientific-computing.html"><a href="gpus-for-scientific-computing.html"><i class="fa fa-check"></i><b>10</b> GPUs for Scientific Computing</a>
<ul>
<li class="chapter" data-level="10.1" data-path="gpus-for-scientific-computing.html"><a href="gpus-for-scientific-computing.html#gpus-in-r"><i class="fa fa-check"></i><b>10.1</b> GPUs in R</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="gpus-for-scientific-computing.html"><a href="gpus-for-scientific-computing.html#example-i-matrix-multiplication-comparison-gpur"><i class="fa fa-check"></i><b>10.1.1</b> Example I: Matrix multiplication comparison (<code>gpuR</code>)</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="gpus-for-scientific-computing.html"><a href="gpus-for-scientific-computing.html#gpus-and-machine-learning"><i class="fa fa-check"></i><b>10.2</b> GPUs and Machine Learning</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="gpus-for-scientific-computing.html"><a href="gpus-for-scientific-computing.html#tensorflowkeras-example-predict-housing-prices"><i class="fa fa-check"></i><b>10.2.1</b> Tensorflow/Keras example: predict housing prices</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="gpus-for-scientific-computing.html"><a href="gpus-for-scientific-computing.html#a-word-of-caution"><i class="fa fa-check"></i><b>10.3</b> A word of caution</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="applied-econometrics-with-apache-spark.html"><a href="applied-econometrics-with-apache-spark.html"><i class="fa fa-check"></i><b>11</b> Applied Econometrics with Apache Spark</a>
<ul>
<li class="chapter" data-level="11.1" data-path="applied-econometrics-with-apache-spark.html"><a href="applied-econometrics-with-apache-spark.html#spark-basics"><i class="fa fa-check"></i><b>11.1</b> Spark basics</a></li>
<li class="chapter" data-level="11.2" data-path="applied-econometrics-with-apache-spark.html"><a href="applied-econometrics-with-apache-spark.html#spark-in-r"><i class="fa fa-check"></i><b>11.2</b> Spark in R</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="applied-econometrics-with-apache-spark.html"><a href="applied-econometrics-with-apache-spark.html#data-import-and-summary-statistics"><i class="fa fa-check"></i><b>11.2.1</b> Data import and summary statistics</a></li>
<li class="chapter" data-level="11.2.2" data-path="applied-econometrics-with-apache-spark.html"><a href="applied-econometrics-with-apache-spark.html#regression-analysis-with-sparklyr"><i class="fa fa-check"></i><b>11.2.2</b> Regression analysis with <code>sparklyr</code></a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="appendix-a.html"><a href="appendix-a.html"><i class="fa fa-check"></i><b>A</b> Appendix A</a>
<ul>
<li class="chapter" data-level="A.1" data-path="appendix-a.html"><a href="appendix-a.html#github"><i class="fa fa-check"></i><b>A.1</b> GitHub</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="appendix-a.html"><a href="appendix-a.html#initiate-a-new-repository"><i class="fa fa-check"></i><b>A.1.1</b> Initiate a new repository</a></li>
<li class="chapter" data-level="A.1.2" data-path="appendix-a.html"><a href="appendix-a.html#clone-this-courses-repository"><i class="fa fa-check"></i><b>A.1.2</b> Clone this course’s repository</a></li>
<li class="chapter" data-level="A.1.3" data-path="appendix-a.html"><a href="appendix-a.html#fork-this-courses-repository"><i class="fa fa-check"></i><b>A.1.3</b> Fork this course’s repository</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="appendix-b.html"><a href="appendix-b.html"><i class="fa fa-check"></i><b>B</b> Appendix B</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://umatter.github.io" target="blank">umatter.github.io</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Big Data Analytics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="big-data-cleaning-and-transformation" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> Big Data Cleaning and Transformation</h1>
<p>Preceding the filtering/selection/aggregation of raw data, data cleaning and transformation typically have to be run on large parts of the overall dataset. In practice, the bottleneck is often a lack of RAM. In the following, we explore two strategies that broadly build on the idea of <em>virtual memory</em> (using parts of the hard disk as RAM).</p>
<div id="out-of-memory-strategies" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> ‘Out-of-memory’ strategies</h2>
<p>Virtual memory is in simple words an approach to combining the RAM and mass storage components in order to cope with a lack of RAM. Modern operating systems come with a virtual memory manager that would automatically handle the swapping between RAM and the hard-disk, when running processes that use up too much RAM. However, a virtual memory manager is not specifically developed to perform this task in the context of data analysis. Several strategies have thus been developed to build on the basic idea of virtual memory in the context of data analysis tasks.</p>
<ul>
<li><p><em>Chunked data files on disk</em>: The data analytics software ‘partitions’ the large dataset, maps, and stores the chunks of raw data on disk. What is actually ‘read’ into RAM when importing the data file with this approach is the mapping to the partitions of the actual dataset (the data structure) and some metadata describing the dataset. In R, this approach is implemented in the <code>ff</code> package and several packages building on <code>ff</code>. In this approach, the usage of disk space and the linking between RAM and files on disk is very explicit (and well visible to the user).</p></li>
<li><p><em>Memory mapped files and shared memory</em>: The data analytics software uses segments of virtual memory for the dataset and allows different programs/processes to access it in the same memory segment. Thus, virtual memory is explicitly allocated for one or several specific data analytics tasks. In R, this approach is prominently implemented in the <code>bigmemory</code> package and several packages building on <code>bigmemory</code>.</p></li>
</ul>
<div id="chunking-data-with-the-ff-package" class="section level3" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Chunking data with the <code>ff</code>-package</h3>
<p>Before looking at the more detailed code examples in <span class="citation"><a href="references.html#ref-walkowiak_2016" role="doc-biblioref">Walkowiak</a> (<a href="references.html#ref-walkowiak_2016" role="doc-biblioref">2016</a>)</span>, we investigate how the <code>ff</code> package (and the concept of chunked files) basically works. In order to do so, we first install and load the <code>ff</code> and <code>ffbase</code> packages, as well as the <code>pryr</code> package. We use the already known <code>flights.csv</code>-dataset as an example. When importing data via the <code>ff</code> package, we first have to set up a directory where <code>ff</code> can store the partitioned dataset (recall that this is explicitly/visibly done on disk). As in the code examples of the book, we call this new directory <code>ffdf</code> (after <code>ff</code>-data.frame).</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="big-data-cleaning-and-transformation.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SET UP --------------</span></span>
<span id="cb159-2"><a href="big-data-cleaning-and-transformation.html#cb159-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-3"><a href="big-data-cleaning-and-transformation.html#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(c(&quot;ff&quot;, &quot;ffbase&quot;))</span></span>
<span id="cb159-4"><a href="big-data-cleaning-and-transformation.html#cb159-4" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb159-5"><a href="big-data-cleaning-and-transformation.html#cb159-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ff)</span>
<span id="cb159-6"><a href="big-data-cleaning-and-transformation.html#cb159-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ffbase)</span>
<span id="cb159-7"><a href="big-data-cleaning-and-transformation.html#cb159-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pryr)</span>
<span id="cb159-8"><a href="big-data-cleaning-and-transformation.html#cb159-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-9"><a href="big-data-cleaning-and-transformation.html#cb159-9" aria-hidden="true" tabindex="-1"></a><span class="co"># create directory for ff chunks, and assign directory to ff </span></span>
<span id="cb159-10"><a href="big-data-cleaning-and-transformation.html#cb159-10" aria-hidden="true" tabindex="-1"></a><span class="fu">system</span>(<span class="st">&quot;mkdir ffdf&quot;</span>)</span>
<span id="cb159-11"><a href="big-data-cleaning-and-transformation.html#cb159-11" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">fftempdir =</span> <span class="st">&quot;ffdf&quot;</span>)</span></code></pre></div>
<p>Now we can read in the data with <code>read.table.ffdf</code>. In order to better understand the underlying concept, we record the change in memory in the R environment with <code>mem_change()</code>.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="big-data-cleaning-and-transformation.html#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mem_change</span>(</span>
<span id="cb160-2"><a href="big-data-cleaning-and-transformation.html#cb160-2" aria-hidden="true" tabindex="-1"></a>flights <span class="ot">&lt;-</span> </span>
<span id="cb160-3"><a href="big-data-cleaning-and-transformation.html#cb160-3" aria-hidden="true" tabindex="-1"></a>     <span class="fu">read.table.ffdf</span>(<span class="at">file=</span><span class="st">&quot;data/flights.csv&quot;</span>,</span>
<span id="cb160-4"><a href="big-data-cleaning-and-transformation.html#cb160-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sep=</span><span class="st">&quot;,&quot;</span>,</span>
<span id="cb160-5"><a href="big-data-cleaning-and-transformation.html#cb160-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">VERBOSE=</span><span class="cn">TRUE</span>,</span>
<span id="cb160-6"><a href="big-data-cleaning-and-transformation.html#cb160-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">header=</span><span class="cn">TRUE</span>,</span>
<span id="cb160-7"><a href="big-data-cleaning-and-transformation.html#cb160-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">next.rows=</span><span class="dv">100000</span>,</span>
<span id="cb160-8"><a href="big-data-cleaning-and-transformation.html#cb160-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">colClasses=</span><span class="cn">NA</span>)</span>
<span id="cb160-9"><a href="big-data-cleaning-and-transformation.html#cb160-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## read.table.ffdf 1..100000 (100000)  csv-read=0.351sec ffdf-write=0.043sec
## read.table.ffdf 100001..200000 (100000)  csv-read=0.358sec ffdf-write=0.027sec
## read.table.ffdf 200001..300000 (100000)  csv-read=0.352sec ffdf-write=0.027sec
## read.table.ffdf 300001..336776 (36776)  csv-read=0.137sec ffdf-write=0.017sec
##  csv-read=1.198sec  ffdf-write=0.114sec  TOTAL=1.312sec</code></pre>
<pre><code>## -30.1 MB</code></pre>
<p>Note that there are two substantial differences to what we have previously seen when using <code>fread()</code>. It takes much longer to import a csv into the ffdf structure. However, the RAM allocated to it is much smaller. This is exactly what we would expect, keeping in mind what <code>read.table.ffdf()</code> does in comparison to what <code>fread()</code> does.</p>
<p>Now we can actually have a look at the data chunks created by <code>ff</code>, as well as how the structure of the dataset is represented in the <code>flights</code> object.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="big-data-cleaning-and-transformation.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show the files in the directory keeping the chunks</span></span>
<span id="cb163-2"><a href="big-data-cleaning-and-transformation.html#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">list.files</span>(<span class="st">&quot;ffdf&quot;</span>)</span></code></pre></div>
<pre><code>##   [1] &quot;clone75db307fa93.ff&quot;  &quot;clone75db47da7f7a.ff&quot;
##   [3] &quot;clone75db4bd01be5.ff&quot; &quot;clone75db50764070.ff&quot;
##   [5] &quot;clone8e35360e6853.ff&quot; &quot;clone8e3557fa7930.ff&quot;
##   [7] &quot;clone8e355e79fe83.ff&quot; &quot;clone8e3579525b87.ff&quot;
##   [9] &quot;ff75db238f2277.ff&quot;    &quot;ff75db467c9ca9.ff&quot;   
##  [11] &quot;ff75db5b8705e6.ff&quot;    &quot;ff8e351f52edee.ff&quot;   
##  [13] &quot;ff8e357931e350.ff&quot;    &quot;ff8e3579acefd2.ff&quot;   
##  [15] &quot;ffdf75db104a61b5.ff&quot;  &quot;ffdf75db12381c2.ff&quot;  
##  [17] &quot;ffdf75db12f4060b.ff&quot;  &quot;ffdf75db155ac869.ff&quot; 
##  [19] &quot;ffdf75db17569ab7.ff&quot;  &quot;ffdf75db19bd3c44.ff&quot; 
##  [21] &quot;ffdf75db1a31be36.ff&quot;  &quot;ffdf75db1acb53f1.ff&quot; 
##  [23] &quot;ffdf75db1afbc30.ff&quot;   &quot;ffdf75db1bdd3923.ff&quot; 
##  [25] &quot;ffdf75db1efba4e.ff&quot;   &quot;ffdf75db1efd5577.ff&quot; 
##  [27] &quot;ffdf75db1fad0746.ff&quot;  &quot;ffdf75db20bb1ef4.ff&quot; 
##  [29] &quot;ffdf75db20d27dcd.ff&quot;  &quot;ffdf75db275c430a.ff&quot; 
##  [31] &quot;ffdf75db27b0c953.ff&quot;  &quot;ffdf75db28d5b230.ff&quot; 
##  [33] &quot;ffdf75db29b096a2.ff&quot;  &quot;ffdf75db2a510673.ff&quot; 
##  [35] &quot;ffdf75db2a523ee8.ff&quot;  &quot;ffdf75db2b240bf8.ff&quot; 
##  [37] &quot;ffdf75db2b9129e1.ff&quot;  &quot;ffdf75db2db0aa48.ff&quot; 
##  [39] &quot;ffdf75db30419c13.ff&quot;  &quot;ffdf75db31f15844.ff&quot; 
##  [41] &quot;ffdf75db3314da06.ff&quot;  &quot;ffdf75db37721ddc.ff&quot; 
##  [43] &quot;ffdf75db4068263a.ff&quot;  &quot;ffdf75db436e625f.ff&quot; 
##  [45] &quot;ffdf75db463b8db5.ff&quot;  &quot;ffdf75db46599881.ff&quot; 
##  [47] &quot;ffdf75db473e9042.ff&quot;  &quot;ffdf75db48cee0dd.ff&quot; 
##  [49] &quot;ffdf75db4990d124.ff&quot;  &quot;ffdf75db4b74a57c.ff&quot; 
##  [51] &quot;ffdf75db50e1e5ae.ff&quot;  &quot;ffdf75db51ec6609.ff&quot; 
##  [53] &quot;ffdf75db53cb1709.ff&quot;  &quot;ffdf75db54e2b89.ff&quot;  
##  [55] &quot;ffdf75db54f4609d.ff&quot;  &quot;ffdf75db561e924f.ff&quot; 
##  [57] &quot;ffdf75db5a2309c4.ff&quot;  &quot;ffdf75db5b1ae970.ff&quot; 
##  [59] &quot;ffdf75db5d1285ce.ff&quot;  &quot;ffdf75db5de853dd.ff&quot; 
##  [61] &quot;ffdf75db5efcb02.ff&quot;   &quot;ffdf75db60d638f6.ff&quot; 
##  [63] &quot;ffdf75db641578be.ff&quot;  &quot;ffdf75db662baee6.ff&quot; 
##  [65] &quot;ffdf75db66a014e2.ff&quot;  &quot;ffdf75db672c164e.ff&quot; 
##  [67] &quot;ffdf75db67e14b3c.ff&quot;  &quot;ffdf75db6a4f2906.ff&quot; 
##  [69] &quot;ffdf75db6ac4f9af.ff&quot;  &quot;ffdf75db6b4c5127.ff&quot; 
##  [71] &quot;ffdf75db6be87b71.ff&quot;  &quot;ffdf75db6c31c71.ff&quot;  
##  [73] &quot;ffdf75db6dc7633b.ff&quot;  &quot;ffdf75db6e06dd86.ff&quot; 
##  [75] &quot;ffdf75db6e99304b.ff&quot;  &quot;ffdf75db725a257d.ff&quot; 
##  [77] &quot;ffdf75db727076ab.ff&quot;  &quot;ffdf75db72b0340e.ff&quot; 
##  [79] &quot;ffdf75db74ef3a8a.ff&quot;  &quot;ffdf75db76e92b9f.ff&quot; 
##  [81] &quot;ffdf75db77643f09.ff&quot;  &quot;ffdf75db78083020.ff&quot; 
##  [83] &quot;ffdf75db7a0eb09f.ff&quot;  &quot;ffdf75db7b03a8df.ff&quot; 
##  [85] &quot;ffdf75db7deeba85.ff&quot;  &quot;ffdf75db7ee7bfbb.ff&quot; 
##  [87] &quot;ffdf75db80afc77.ff&quot;   &quot;ffdf75db9f8f75f.ff&quot;  
##  [89] &quot;ffdf75dbae90994.ff&quot;   &quot;ffdf75dbafc362c.ff&quot;  
##  [91] &quot;ffdf75dbb273f69.ff&quot;   &quot;ffdf75dbd1cd10.ff&quot;   
##  [93] &quot;ffdf8e3514dfade1.ff&quot;  &quot;ffdf8e3515fa8211.ff&quot; 
##  [95] &quot;ffdf8e3518d21571.ff&quot;  &quot;ffdf8e351c061b0e.ff&quot; 
##  [97] &quot;ffdf8e351d03c750.ff&quot;  &quot;ffdf8e351f24f13c.ff&quot; 
##  [99] &quot;ffdf8e35204f468.ff&quot;   &quot;ffdf8e3520749287.ff&quot; 
## [101] &quot;ffdf8e35213843be.ff&quot;  &quot;ffdf8e352157e257.ff&quot; 
## [103] &quot;ffdf8e35238a0f83.ff&quot;  &quot;ffdf8e352390a28e.ff&quot; 
## [105] &quot;ffdf8e3523efdb6a.ff&quot;  &quot;ffdf8e35243f7204.ff&quot; 
## [107] &quot;ffdf8e35266058d8.ff&quot;  &quot;ffdf8e352719254a.ff&quot; 
## [109] &quot;ffdf8e352ac66b45.ff&quot;  &quot;ffdf8e352b16ccee.ff&quot; 
## [111] &quot;ffdf8e352c9928d7.ff&quot;  &quot;ffdf8e352ead5d77.ff&quot; 
## [113] &quot;ffdf8e35328682a.ff&quot;   &quot;ffdf8e3532e1e0bb.ff&quot; 
## [115] &quot;ffdf8e35377dee1d.ff&quot;  &quot;ffdf8e3537cbb5c8.ff&quot; 
## [117] &quot;ffdf8e353803181e.ff&quot;  &quot;ffdf8e3538a78b41.ff&quot; 
## [119] &quot;ffdf8e353944cdf5.ff&quot;  &quot;ffdf8e353969089.ff&quot;  
## [121] &quot;ffdf8e3539cc5f85.ff&quot;  &quot;ffdf8e353addce7a.ff&quot; 
## [123] &quot;ffdf8e353be15cf0.ff&quot;  &quot;ffdf8e353d328ef5.ff&quot; 
## [125] &quot;ffdf8e353d8d734a.ff&quot;  &quot;ffdf8e3540097a02.ff&quot; 
## [127] &quot;ffdf8e3541eb9253.ff&quot;  &quot;ffdf8e3545c5183f.ff&quot; 
## [129] &quot;ffdf8e354614e0dc.ff&quot;  &quot;ffdf8e3546234b48.ff&quot; 
## [131] &quot;ffdf8e35481464cb.ff&quot;  &quot;ffdf8e35489d7a69.ff&quot; 
## [133] &quot;ffdf8e354b58974e.ff&quot;  &quot;ffdf8e354bfb4ef3.ff&quot; 
## [135] &quot;ffdf8e354c620628.ff&quot;  &quot;ffdf8e354c765b75.ff&quot; 
## [137] &quot;ffdf8e354d797e22.ff&quot;  &quot;ffdf8e354ede9f1e.ff&quot; 
## [139] &quot;ffdf8e354fc4b1cb.ff&quot;  &quot;ffdf8e354fe5a135.ff&quot; 
## [141] &quot;ffdf8e3556bbe7be.ff&quot;  &quot;ffdf8e35585756f5.ff&quot; 
## [143] &quot;ffdf8e355a913a9b.ff&quot;  &quot;ffdf8e355b526101.ff&quot; 
## [145] &quot;ffdf8e355db9a2c5.ff&quot;  &quot;ffdf8e355dbc3aef.ff&quot; 
## [147] &quot;ffdf8e355f80a38f.ff&quot;  &quot;ffdf8e355fd1385b.ff&quot; 
## [149] &quot;ffdf8e3560253dd.ff&quot;   &quot;ffdf8e35618f7b7f.ff&quot; 
## [151] &quot;ffdf8e356624a0da.ff&quot;  &quot;ffdf8e3567b93c51.ff&quot; 
## [153] &quot;ffdf8e356b555a53.ff&quot;  &quot;ffdf8e356b86f764.ff&quot; 
## [155] &quot;ffdf8e356d73161.ff&quot;   &quot;ffdf8e356f8dfd2f.ff&quot; 
## [157] &quot;ffdf8e3570932676.ff&quot;  &quot;ffdf8e35763e2d39.ff&quot; 
## [159] &quot;ffdf8e3577a6492c.ff&quot;  &quot;ffdf8e357862a5f.ff&quot;  
## [161] &quot;ffdf8e3579b7481c.ff&quot;  &quot;ffdf8e357a7ffc73.ff&quot; 
## [163] &quot;ffdf8e357b0c82.ff&quot;    &quot;ffdf8e357d0c49e9.ff&quot; 
## [165] &quot;ffdf8e357def0110.ff&quot;  &quot;ffdf8e3592a6f2a.ff&quot;  
## [167] &quot;ffdf8e359ff998c.ff&quot;   &quot;ffdf8e35a97707d.ff&quot;  
## [169] &quot;ffdf8e35bfade79.ff&quot;   &quot;ffdf8e35fd54512.ff&quot;  
## [171] &quot;ffdf9ff6110d9311.ff&quot;  &quot;ffdf9ff62618d903.ff&quot; 
## [173] &quot;ffdf9ff634fd2ad2.ff&quot;  &quot;ffdf9ff63e64c093.ff&quot; 
## [175] &quot;ffdf9ff640be3484.ff&quot;  &quot;ffdf9ff64cfd0de8.ff&quot; 
## [177] &quot;ffdf9ff650563688.ff&quot;  &quot;ffdf9ff651294af2.ff&quot; 
## [179] &quot;ffdf9ff65e6fe4d9.ff&quot;  &quot;ffdf9ff66015dce1.ff&quot; 
## [181] &quot;ffdf9ff660fb5d.ff&quot;    &quot;ffdf9ff663959724.ff&quot; 
## [183] &quot;ffdf9ff664b123d2.ff&quot;  &quot;ffdf9ff6654a181b.ff&quot; 
## [185] &quot;ffdf9ff666899228.ff&quot;  &quot;ffdf9ff6759640a4.ff&quot; 
## [187] &quot;ffdf9ff6760573f.ff&quot;   &quot;ffdf9ff67e922a3e.ff&quot; 
## [189] &quot;ffdf9ff6dbb3e0b.ff&quot;</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="big-data-cleaning-and-transformation.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># investigate the structure of the object created in the R environment</span></span>
<span id="cb165-2"><a href="big-data-cleaning-and-transformation.html#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(flights)</span></code></pre></div>
<pre><code>## List of 3
##  $ virtual: &#39;data.frame&#39;:    19 obs. of  7 variables:
##  .. $ VirtualVmode     : chr  &quot;integer&quot; &quot;integer&quot; &quot;integer&quot; &quot;integer&quot; ...
##  .. $ AsIs             : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
##  .. $ VirtualIsMatrix  : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
##  .. $ PhysicalIsMatrix : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
##  .. $ PhysicalElementNo: int  1 2 3 4 5 6 7 8 9 10 ...
##  .. $ PhysicalFirstCol : int  1 1 1 1 1 1 1 1 1 1 ...
##  .. $ PhysicalLastCol  : int  1 1 1 1 1 1 1 1 1 1 ...
##  .. - attr(*, &quot;Dim&quot;)= int [1:2] 336776 19
##  .. - attr(*, &quot;Dimorder&quot;)= int [1:2] 1 2
##  $ physical: List of 19
##  .. $ year          : list()
##  ..  ..- attr(*, &quot;physical&quot;)=Class &#39;ff_pointer&#39; &lt;externalptr&gt; 
##  ..  .. ..- attr(*, &quot;vmode&quot;)= chr &quot;integer&quot;
##  ..  .. ..- attr(*, &quot;maxlength&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;pattern&quot;)= chr &quot;ffdf&quot;
##  ..  .. ..- attr(*, &quot;filename&quot;)= chr &quot;/home/umatter/Dropbox/Teaching/HSG/BigData/BigData/ffdf/ffdf9ff63e64c093.ff&quot;
##  ..  .. ..- attr(*, &quot;pagesize&quot;)= int 65536
##  ..  .. ..- attr(*, &quot;finalizer&quot;)= chr &quot;close&quot;
##  ..  .. ..- attr(*, &quot;finonexit&quot;)= logi TRUE
##  ..  .. ..- attr(*, &quot;readonly&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;caching&quot;)= chr &quot;mmnoflush&quot;
##  ..  ..- attr(*, &quot;virtual&quot;)= list()
##  ..  .. ..- attr(*, &quot;Length&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;Symmetric&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;class&quot;)= chr &quot;virtual&quot;
##  .. .. - attr(*, &quot;class&quot;) =  chr [1:2] &quot;ff_vector&quot; &quot;ff&quot;
##  .. $ month         : list()
##  ..  ..- attr(*, &quot;physical&quot;)=Class &#39;ff_pointer&#39; &lt;externalptr&gt; 
##  ..  .. ..- attr(*, &quot;vmode&quot;)= chr &quot;integer&quot;
##  ..  .. ..- attr(*, &quot;maxlength&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;pattern&quot;)= chr &quot;ffdf&quot;
##  ..  .. ..- attr(*, &quot;filename&quot;)= chr &quot;/home/umatter/Dropbox/Teaching/HSG/BigData/BigData/ffdf/ffdf9ff6110d9311.ff&quot;
##  ..  .. ..- attr(*, &quot;pagesize&quot;)= int 65536
##  ..  .. ..- attr(*, &quot;finalizer&quot;)= chr &quot;close&quot;
##  ..  .. ..- attr(*, &quot;finonexit&quot;)= logi TRUE
##  ..  .. ..- attr(*, &quot;readonly&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;caching&quot;)= chr &quot;mmnoflush&quot;
##  ..  ..- attr(*, &quot;virtual&quot;)= list()
##  ..  .. ..- attr(*, &quot;Length&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;Symmetric&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;class&quot;)= chr &quot;virtual&quot;
##  .. .. - attr(*, &quot;class&quot;) =  chr [1:2] &quot;ff_vector&quot; &quot;ff&quot;
##  .. $ day           : list()
##  ..  ..- attr(*, &quot;physical&quot;)=Class &#39;ff_pointer&#39; &lt;externalptr&gt; 
##  ..  .. ..- attr(*, &quot;vmode&quot;)= chr &quot;integer&quot;
##  ..  .. ..- attr(*, &quot;maxlength&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;pattern&quot;)= chr &quot;ffdf&quot;
##  ..  .. ..- attr(*, &quot;filename&quot;)= chr &quot;/home/umatter/Dropbox/Teaching/HSG/BigData/BigData/ffdf/ffdf9ff6759640a4.ff&quot;
##  ..  .. ..- attr(*, &quot;pagesize&quot;)= int 65536
##  ..  .. ..- attr(*, &quot;finalizer&quot;)= chr &quot;close&quot;
##  ..  .. ..- attr(*, &quot;finonexit&quot;)= logi TRUE
##  ..  .. ..- attr(*, &quot;readonly&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;caching&quot;)= chr &quot;mmnoflush&quot;
##  ..  ..- attr(*, &quot;virtual&quot;)= list()
##  ..  .. ..- attr(*, &quot;Length&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;Symmetric&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;class&quot;)= chr &quot;virtual&quot;
##  .. .. - attr(*, &quot;class&quot;) =  chr [1:2] &quot;ff_vector&quot; &quot;ff&quot;
##  .. $ dep_time      : list()
##  ..  ..- attr(*, &quot;physical&quot;)=Class &#39;ff_pointer&#39; &lt;externalptr&gt; 
##  ..  .. ..- attr(*, &quot;vmode&quot;)= chr &quot;integer&quot;
##  ..  .. ..- attr(*, &quot;maxlength&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;pattern&quot;)= chr &quot;ffdf&quot;
##  ..  .. ..- attr(*, &quot;filename&quot;)= chr &quot;/home/umatter/Dropbox/Teaching/HSG/BigData/BigData/ffdf/ffdf9ff6654a181b.ff&quot;
##  ..  .. ..- attr(*, &quot;pagesize&quot;)= int 65536
##  ..  .. ..- attr(*, &quot;finalizer&quot;)= chr &quot;close&quot;
##  ..  .. ..- attr(*, &quot;finonexit&quot;)= logi TRUE
##  ..  .. ..- attr(*, &quot;readonly&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;caching&quot;)= chr &quot;mmnoflush&quot;
##  ..  ..- attr(*, &quot;virtual&quot;)= list()
##  ..  .. ..- attr(*, &quot;Length&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;Symmetric&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;class&quot;)= chr &quot;virtual&quot;
##  .. .. - attr(*, &quot;class&quot;) =  chr [1:2] &quot;ff_vector&quot; &quot;ff&quot;
##  .. $ sched_dep_time: list()
##  ..  ..- attr(*, &quot;physical&quot;)=Class &#39;ff_pointer&#39; &lt;externalptr&gt; 
##  ..  .. ..- attr(*, &quot;vmode&quot;)= chr &quot;integer&quot;
##  ..  .. ..- attr(*, &quot;maxlength&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;pattern&quot;)= chr &quot;ffdf&quot;
##  ..  .. ..- attr(*, &quot;filename&quot;)= chr &quot;/home/umatter/Dropbox/Teaching/HSG/BigData/BigData/ffdf/ffdf9ff651294af2.ff&quot;
##  ..  .. ..- attr(*, &quot;pagesize&quot;)= int 65536
##  ..  .. ..- attr(*, &quot;finalizer&quot;)= chr &quot;close&quot;
##  ..  .. ..- attr(*, &quot;finonexit&quot;)= logi TRUE
##  ..  .. ..- attr(*, &quot;readonly&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;caching&quot;)= chr &quot;mmnoflush&quot;
##  ..  ..- attr(*, &quot;virtual&quot;)= list()
##  ..  .. ..- attr(*, &quot;Length&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;Symmetric&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;class&quot;)= chr &quot;virtual&quot;
##  .. .. - attr(*, &quot;class&quot;) =  chr [1:2] &quot;ff_vector&quot; &quot;ff&quot;
##  .. $ dep_delay     : list()
##  ..  ..- attr(*, &quot;physical&quot;)=Class &#39;ff_pointer&#39; &lt;externalptr&gt; 
##  ..  .. ..- attr(*, &quot;vmode&quot;)= chr &quot;integer&quot;
##  ..  .. ..- attr(*, &quot;maxlength&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;pattern&quot;)= chr &quot;ffdf&quot;
##  ..  .. ..- attr(*, &quot;filename&quot;)= chr &quot;/home/umatter/Dropbox/Teaching/HSG/BigData/BigData/ffdf/ffdf9ff660fb5d.ff&quot;
##  ..  .. ..- attr(*, &quot;pagesize&quot;)= int 65536
##  ..  .. ..- attr(*, &quot;finalizer&quot;)= chr &quot;close&quot;
##  ..  .. ..- attr(*, &quot;finonexit&quot;)= logi TRUE
##  ..  .. ..- attr(*, &quot;readonly&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;caching&quot;)= chr &quot;mmnoflush&quot;
##  ..  ..- attr(*, &quot;virtual&quot;)= list()
##  ..  .. ..- attr(*, &quot;Length&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;Symmetric&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;class&quot;)= chr &quot;virtual&quot;
##  .. .. - attr(*, &quot;class&quot;) =  chr [1:2] &quot;ff_vector&quot; &quot;ff&quot;
##  .. $ arr_time      : list()
##  ..  ..- attr(*, &quot;physical&quot;)=Class &#39;ff_pointer&#39; &lt;externalptr&gt; 
##  ..  .. ..- attr(*, &quot;vmode&quot;)= chr &quot;integer&quot;
##  ..  .. ..- attr(*, &quot;maxlength&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;pattern&quot;)= chr &quot;ffdf&quot;
##  ..  .. ..- attr(*, &quot;filename&quot;)= chr &quot;/home/umatter/Dropbox/Teaching/HSG/BigData/BigData/ffdf/ffdf9ff634fd2ad2.ff&quot;
##  ..  .. ..- attr(*, &quot;pagesize&quot;)= int 65536
##  ..  .. ..- attr(*, &quot;finalizer&quot;)= chr &quot;close&quot;
##  ..  .. ..- attr(*, &quot;finonexit&quot;)= logi TRUE
##  ..  .. ..- attr(*, &quot;readonly&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;caching&quot;)= chr &quot;mmnoflush&quot;
##  ..  ..- attr(*, &quot;virtual&quot;)= list()
##  ..  .. ..- attr(*, &quot;Length&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;Symmetric&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;class&quot;)= chr &quot;virtual&quot;
##  .. .. - attr(*, &quot;class&quot;) =  chr [1:2] &quot;ff_vector&quot; &quot;ff&quot;
##  .. $ sched_arr_time: list()
##  ..  ..- attr(*, &quot;physical&quot;)=Class &#39;ff_pointer&#39; &lt;externalptr&gt; 
##  ..  .. ..- attr(*, &quot;vmode&quot;)= chr &quot;integer&quot;
##  ..  .. ..- attr(*, &quot;maxlength&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;pattern&quot;)= chr &quot;ffdf&quot;
##  ..  .. ..- attr(*, &quot;filename&quot;)= chr &quot;/home/umatter/Dropbox/Teaching/HSG/BigData/BigData/ffdf/ffdf9ff663959724.ff&quot;
##  ..  .. ..- attr(*, &quot;pagesize&quot;)= int 65536
##  ..  .. ..- attr(*, &quot;finalizer&quot;)= chr &quot;close&quot;
##  ..  .. ..- attr(*, &quot;finonexit&quot;)= logi TRUE
##  ..  .. ..- attr(*, &quot;readonly&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;caching&quot;)= chr &quot;mmnoflush&quot;
##  ..  ..- attr(*, &quot;virtual&quot;)= list()
##  ..  .. ..- attr(*, &quot;Length&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;Symmetric&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;class&quot;)= chr &quot;virtual&quot;
##  .. .. - attr(*, &quot;class&quot;) =  chr [1:2] &quot;ff_vector&quot; &quot;ff&quot;
##  .. $ arr_delay     : list()
##  ..  ..- attr(*, &quot;physical&quot;)=Class &#39;ff_pointer&#39; &lt;externalptr&gt; 
##  ..  .. ..- attr(*, &quot;vmode&quot;)= chr &quot;integer&quot;
##  ..  .. ..- attr(*, &quot;maxlength&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;pattern&quot;)= chr &quot;ffdf&quot;
##  ..  .. ..- attr(*, &quot;filename&quot;)= chr &quot;/home/umatter/Dropbox/Teaching/HSG/BigData/BigData/ffdf/ffdf9ff62618d903.ff&quot;
##  ..  .. ..- attr(*, &quot;pagesize&quot;)= int 65536
##  ..  .. ..- attr(*, &quot;finalizer&quot;)= chr &quot;close&quot;
##  ..  .. ..- attr(*, &quot;finonexit&quot;)= logi TRUE
##  ..  .. ..- attr(*, &quot;readonly&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;caching&quot;)= chr &quot;mmnoflush&quot;
##  ..  ..- attr(*, &quot;virtual&quot;)= list()
##  ..  .. ..- attr(*, &quot;Length&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;Symmetric&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;class&quot;)= chr &quot;virtual&quot;
##  .. .. - attr(*, &quot;class&quot;) =  chr [1:2] &quot;ff_vector&quot; &quot;ff&quot;
##  .. $ carrier       : list()
##  ..  ..- attr(*, &quot;physical&quot;)=Class &#39;ff_pointer&#39; &lt;externalptr&gt; 
##  ..  .. ..- attr(*, &quot;vmode&quot;)= chr &quot;integer&quot;
##  ..  .. ..- attr(*, &quot;maxlength&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;pattern&quot;)= chr &quot;ffdf&quot;
##  ..  .. ..- attr(*, &quot;filename&quot;)= chr &quot;/home/umatter/Dropbox/Teaching/HSG/BigData/BigData/ffdf/ffdf9ff6760573f.ff&quot;
##  ..  .. ..- attr(*, &quot;pagesize&quot;)= int 65536
##  ..  .. ..- attr(*, &quot;finalizer&quot;)= chr &quot;close&quot;
##  ..  .. ..- attr(*, &quot;finonexit&quot;)= logi TRUE
##  ..  .. ..- attr(*, &quot;readonly&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;caching&quot;)= chr &quot;mmnoflush&quot;
##  ..  ..- attr(*, &quot;virtual&quot;)= list()
##  ..  .. ..- attr(*, &quot;Length&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;Symmetric&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;Levels&quot;)= chr [1:16] &quot;9E&quot; &quot;AA&quot; &quot;AS&quot; &quot;B6&quot; ...
##  ..  .. ..- attr(*, &quot;ramclass&quot;)= chr &quot;factor&quot;
##  ..  .. ..- attr(*, &quot;class&quot;)= chr &quot;virtual&quot;
##  .. .. - attr(*, &quot;class&quot;) =  chr [1:2] &quot;ff_vector&quot; &quot;ff&quot;
##  .. $ flight        : list()
##  ..  ..- attr(*, &quot;physical&quot;)=Class &#39;ff_pointer&#39; &lt;externalptr&gt; 
##  ..  .. ..- attr(*, &quot;vmode&quot;)= chr &quot;integer&quot;
##  ..  .. ..- attr(*, &quot;maxlength&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;pattern&quot;)= chr &quot;ffdf&quot;
##  ..  .. ..- attr(*, &quot;filename&quot;)= chr &quot;/home/umatter/Dropbox/Teaching/HSG/BigData/BigData/ffdf/ffdf9ff650563688.ff&quot;
##  ..  .. ..- attr(*, &quot;pagesize&quot;)= int 65536
##  ..  .. ..- attr(*, &quot;finalizer&quot;)= chr &quot;close&quot;
##  ..  .. ..- attr(*, &quot;finonexit&quot;)= logi TRUE
##  ..  .. ..- attr(*, &quot;readonly&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;caching&quot;)= chr &quot;mmnoflush&quot;
##  ..  ..- attr(*, &quot;virtual&quot;)= list()
##  ..  .. ..- attr(*, &quot;Length&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;Symmetric&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;class&quot;)= chr &quot;virtual&quot;
##  .. .. - attr(*, &quot;class&quot;) =  chr [1:2] &quot;ff_vector&quot; &quot;ff&quot;
##  .. $ tailnum       : list()
##  ..  ..- attr(*, &quot;physical&quot;)=Class &#39;ff_pointer&#39; &lt;externalptr&gt; 
##  ..  .. ..- attr(*, &quot;vmode&quot;)= chr &quot;integer&quot;
##  ..  .. ..- attr(*, &quot;maxlength&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;pattern&quot;)= chr &quot;ffdf&quot;
##  ..  .. ..- attr(*, &quot;filename&quot;)= chr &quot;/home/umatter/Dropbox/Teaching/HSG/BigData/BigData/ffdf/ffdf9ff664b123d2.ff&quot;
##  ..  .. ..- attr(*, &quot;pagesize&quot;)= int 65536
##  ..  .. ..- attr(*, &quot;finalizer&quot;)= chr &quot;close&quot;
##  ..  .. ..- attr(*, &quot;finonexit&quot;)= logi TRUE
##  ..  .. ..- attr(*, &quot;readonly&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;caching&quot;)= chr &quot;mmnoflush&quot;
##  ..  ..- attr(*, &quot;virtual&quot;)= list()
##  ..  .. ..- attr(*, &quot;Length&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;Symmetric&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;Levels&quot;)= chr [1:4044] &quot;&quot; &quot;N0EGMQ&quot; &quot;N10156&quot; &quot;N102UW&quot; ...
##  ..  .. ..- attr(*, &quot;ramclass&quot;)= chr &quot;factor&quot;
##  ..  .. ..- attr(*, &quot;class&quot;)= chr &quot;virtual&quot;
##  .. .. - attr(*, &quot;class&quot;) =  chr [1:2] &quot;ff_vector&quot; &quot;ff&quot;
##  .. $ origin        : list()
##  ..  ..- attr(*, &quot;physical&quot;)=Class &#39;ff_pointer&#39; &lt;externalptr&gt; 
##  ..  .. ..- attr(*, &quot;vmode&quot;)= chr &quot;integer&quot;
##  ..  .. ..- attr(*, &quot;maxlength&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;pattern&quot;)= chr &quot;ffdf&quot;
##  ..  .. ..- attr(*, &quot;filename&quot;)= chr &quot;/home/umatter/Dropbox/Teaching/HSG/BigData/BigData/ffdf/ffdf9ff65e6fe4d9.ff&quot;
##  ..  .. ..- attr(*, &quot;pagesize&quot;)= int 65536
##  ..  .. ..- attr(*, &quot;finalizer&quot;)= chr &quot;close&quot;
##  ..  .. ..- attr(*, &quot;finonexit&quot;)= logi TRUE
##  ..  .. ..- attr(*, &quot;readonly&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;caching&quot;)= chr &quot;mmnoflush&quot;
##  ..  ..- attr(*, &quot;virtual&quot;)= list()
##  ..  .. ..- attr(*, &quot;Length&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;Symmetric&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;Levels&quot;)= chr [1:3] &quot;EWR&quot; &quot;JFK&quot; &quot;LGA&quot;
##  ..  .. ..- attr(*, &quot;ramclass&quot;)= chr &quot;factor&quot;
##  ..  .. ..- attr(*, &quot;class&quot;)= chr &quot;virtual&quot;
##  .. .. - attr(*, &quot;class&quot;) =  chr [1:2] &quot;ff_vector&quot; &quot;ff&quot;
##  .. $ dest          : list()
##  ..  ..- attr(*, &quot;physical&quot;)=Class &#39;ff_pointer&#39; &lt;externalptr&gt; 
##  ..  .. ..- attr(*, &quot;vmode&quot;)= chr &quot;integer&quot;
##  ..  .. ..- attr(*, &quot;maxlength&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;pattern&quot;)= chr &quot;ffdf&quot;
##  ..  .. ..- attr(*, &quot;filename&quot;)= chr &quot;/home/umatter/Dropbox/Teaching/HSG/BigData/BigData/ffdf/ffdf9ff64cfd0de8.ff&quot;
##  ..  .. ..- attr(*, &quot;pagesize&quot;)= int 65536
##  ..  .. ..- attr(*, &quot;finalizer&quot;)= chr &quot;close&quot;
##  ..  .. ..- attr(*, &quot;finonexit&quot;)= logi TRUE
##  ..  .. ..- attr(*, &quot;readonly&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;caching&quot;)= chr &quot;mmnoflush&quot;
##  ..  ..- attr(*, &quot;virtual&quot;)= list()
##  ..  .. ..- attr(*, &quot;Length&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;Symmetric&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;Levels&quot;)= chr [1:105] &quot;ABQ&quot; &quot;ACK&quot; &quot;ALB&quot; &quot;ATL&quot; ...
##  ..  .. ..- attr(*, &quot;ramclass&quot;)= chr &quot;factor&quot;
##  ..  .. ..- attr(*, &quot;class&quot;)= chr &quot;virtual&quot;
##  .. .. - attr(*, &quot;class&quot;) =  chr [1:2] &quot;ff_vector&quot; &quot;ff&quot;
##  .. $ air_time      : list()
##  ..  ..- attr(*, &quot;physical&quot;)=Class &#39;ff_pointer&#39; &lt;externalptr&gt; 
##  ..  .. ..- attr(*, &quot;vmode&quot;)= chr &quot;integer&quot;
##  ..  .. ..- attr(*, &quot;maxlength&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;pattern&quot;)= chr &quot;ffdf&quot;
##  ..  .. ..- attr(*, &quot;filename&quot;)= chr &quot;/home/umatter/Dropbox/Teaching/HSG/BigData/BigData/ffdf/ffdf9ff640be3484.ff&quot;
##  ..  .. ..- attr(*, &quot;pagesize&quot;)= int 65536
##  ..  .. ..- attr(*, &quot;finalizer&quot;)= chr &quot;close&quot;
##  ..  .. ..- attr(*, &quot;finonexit&quot;)= logi TRUE
##  ..  .. ..- attr(*, &quot;readonly&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;caching&quot;)= chr &quot;mmnoflush&quot;
##  ..  ..- attr(*, &quot;virtual&quot;)= list()
##  ..  .. ..- attr(*, &quot;Length&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;Symmetric&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;class&quot;)= chr &quot;virtual&quot;
##  .. .. - attr(*, &quot;class&quot;) =  chr [1:2] &quot;ff_vector&quot; &quot;ff&quot;
##  .. $ distance      : list()
##  ..  ..- attr(*, &quot;physical&quot;)=Class &#39;ff_pointer&#39; &lt;externalptr&gt; 
##  ..  .. ..- attr(*, &quot;vmode&quot;)= chr &quot;integer&quot;
##  ..  .. ..- attr(*, &quot;maxlength&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;pattern&quot;)= chr &quot;ffdf&quot;
##  ..  .. ..- attr(*, &quot;filename&quot;)= chr &quot;/home/umatter/Dropbox/Teaching/HSG/BigData/BigData/ffdf/ffdf9ff67e922a3e.ff&quot;
##  ..  .. ..- attr(*, &quot;pagesize&quot;)= int 65536
##  ..  .. ..- attr(*, &quot;finalizer&quot;)= chr &quot;close&quot;
##  ..  .. ..- attr(*, &quot;finonexit&quot;)= logi TRUE
##  ..  .. ..- attr(*, &quot;readonly&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;caching&quot;)= chr &quot;mmnoflush&quot;
##  ..  ..- attr(*, &quot;virtual&quot;)= list()
##  ..  .. ..- attr(*, &quot;Length&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;Symmetric&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;class&quot;)= chr &quot;virtual&quot;
##  .. .. - attr(*, &quot;class&quot;) =  chr [1:2] &quot;ff_vector&quot; &quot;ff&quot;
##  .. $ hour          : list()
##  ..  ..- attr(*, &quot;physical&quot;)=Class &#39;ff_pointer&#39; &lt;externalptr&gt; 
##  ..  .. ..- attr(*, &quot;vmode&quot;)= chr &quot;integer&quot;
##  ..  .. ..- attr(*, &quot;maxlength&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;pattern&quot;)= chr &quot;ffdf&quot;
##  ..  .. ..- attr(*, &quot;filename&quot;)= chr &quot;/home/umatter/Dropbox/Teaching/HSG/BigData/BigData/ffdf/ffdf9ff6dbb3e0b.ff&quot;
##  ..  .. ..- attr(*, &quot;pagesize&quot;)= int 65536
##  ..  .. ..- attr(*, &quot;finalizer&quot;)= chr &quot;close&quot;
##  ..  .. ..- attr(*, &quot;finonexit&quot;)= logi TRUE
##  ..  .. ..- attr(*, &quot;readonly&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;caching&quot;)= chr &quot;mmnoflush&quot;
##  ..  ..- attr(*, &quot;virtual&quot;)= list()
##  ..  .. ..- attr(*, &quot;Length&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;Symmetric&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;class&quot;)= chr &quot;virtual&quot;
##  .. .. - attr(*, &quot;class&quot;) =  chr [1:2] &quot;ff_vector&quot; &quot;ff&quot;
##  .. $ minute        : list()
##  ..  ..- attr(*, &quot;physical&quot;)=Class &#39;ff_pointer&#39; &lt;externalptr&gt; 
##  ..  .. ..- attr(*, &quot;vmode&quot;)= chr &quot;integer&quot;
##  ..  .. ..- attr(*, &quot;maxlength&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;pattern&quot;)= chr &quot;ffdf&quot;
##  ..  .. ..- attr(*, &quot;filename&quot;)= chr &quot;/home/umatter/Dropbox/Teaching/HSG/BigData/BigData/ffdf/ffdf9ff66015dce1.ff&quot;
##  ..  .. ..- attr(*, &quot;pagesize&quot;)= int 65536
##  ..  .. ..- attr(*, &quot;finalizer&quot;)= chr &quot;close&quot;
##  ..  .. ..- attr(*, &quot;finonexit&quot;)= logi TRUE
##  ..  .. ..- attr(*, &quot;readonly&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;caching&quot;)= chr &quot;mmnoflush&quot;
##  ..  ..- attr(*, &quot;virtual&quot;)= list()
##  ..  .. ..- attr(*, &quot;Length&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;Symmetric&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;class&quot;)= chr &quot;virtual&quot;
##  .. .. - attr(*, &quot;class&quot;) =  chr [1:2] &quot;ff_vector&quot; &quot;ff&quot;
##  .. $ time_hour     : list()
##  ..  ..- attr(*, &quot;physical&quot;)=Class &#39;ff_pointer&#39; &lt;externalptr&gt; 
##  ..  .. ..- attr(*, &quot;vmode&quot;)= chr &quot;integer&quot;
##  ..  .. ..- attr(*, &quot;maxlength&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;pattern&quot;)= chr &quot;ffdf&quot;
##  ..  .. ..- attr(*, &quot;filename&quot;)= chr &quot;/home/umatter/Dropbox/Teaching/HSG/BigData/BigData/ffdf/ffdf9ff666899228.ff&quot;
##  ..  .. ..- attr(*, &quot;pagesize&quot;)= int 65536
##  ..  .. ..- attr(*, &quot;finalizer&quot;)= chr &quot;close&quot;
##  ..  .. ..- attr(*, &quot;finonexit&quot;)= logi TRUE
##  ..  .. ..- attr(*, &quot;readonly&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;caching&quot;)= chr &quot;mmnoflush&quot;
##  ..  ..- attr(*, &quot;virtual&quot;)= list()
##  ..  .. ..- attr(*, &quot;Length&quot;)= int 336776
##  ..  .. ..- attr(*, &quot;Symmetric&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;Levels&quot;)= chr [1:6936] &quot;2013-01-01T10:00:00Z&quot; &quot;2013-01-01T11:00:00Z&quot; &quot;2013-01-01T12:00:00Z&quot; &quot;2013-01-01T13:00:00Z&quot; ...
##  ..  .. ..- attr(*, &quot;ramclass&quot;)= chr &quot;factor&quot;
##  ..  .. ..- attr(*, &quot;class&quot;)= chr &quot;virtual&quot;
##  .. .. - attr(*, &quot;class&quot;) =  chr [1:2] &quot;ff_vector&quot; &quot;ff&quot;
##  $ row.names:  NULL
## - attributes: List of 2
##  .. $ names: chr [1:3] &quot;virtual&quot; &quot;physical&quot; &quot;row.names&quot;
##  .. $ class: chr &quot;ffdf&quot;</code></pre>
</div>
<div id="memory-mapping-with-bigmemory" class="section level3" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Memory mapping with <code>bigmemory</code></h3>
<p>The <code>bigmemory</code>-package handles data in matrices, and therefore only accepts variables in the same data type. Before importing data via the <code>bigmemory</code>-package, we thus have to ensure that all variables in the raw data can be imported in a common type. This example follows the example of the package authors given <a href="https://cran.r-project.org/web/packages/bigmemory/vignettes/Overview.pdf">here</a>.<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a></p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="big-data-cleaning-and-transformation.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SET UP ----------------</span></span>
<span id="cb167-2"><a href="big-data-cleaning-and-transformation.html#cb167-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-3"><a href="big-data-cleaning-and-transformation.html#cb167-3" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb167-4"><a href="big-data-cleaning-and-transformation.html#cb167-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bigmemory)</span>
<span id="cb167-5"><a href="big-data-cleaning-and-transformation.html#cb167-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(biganalytics)</span>
<span id="cb167-6"><a href="big-data-cleaning-and-transformation.html#cb167-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-7"><a href="big-data-cleaning-and-transformation.html#cb167-7" aria-hidden="true" tabindex="-1"></a><span class="co"># import the data</span></span>
<span id="cb167-8"><a href="big-data-cleaning-and-transformation.html#cb167-8" aria-hidden="true" tabindex="-1"></a>flights <span class="ot">&lt;-</span> <span class="fu">read.big.matrix</span>(<span class="st">&quot;data/flights.csv&quot;</span>,</span>
<span id="cb167-9"><a href="big-data-cleaning-and-transformation.html#cb167-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">type=</span><span class="st">&quot;integer&quot;</span>,</span>
<span id="cb167-10"><a href="big-data-cleaning-and-transformation.html#cb167-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">header=</span><span class="cn">TRUE</span>,</span>
<span id="cb167-11"><a href="big-data-cleaning-and-transformation.html#cb167-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">backingfile=</span><span class="st">&quot;flights.bin&quot;</span>,</span>
<span id="cb167-12"><a href="big-data-cleaning-and-transformation.html#cb167-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">descriptorfile=</span><span class="st">&quot;flights.desc&quot;</span>)</span></code></pre></div>
<p>Note that, similar to the <code>ff</code>-example, <code>read.big.matrix()</code> initiates a local file-backing <code>flights.bin</code> on disk which is linked to the <code>flights</code>-object in RAM. From looking at the imported file, we see that various variable values have been discarded. This is due to the fact that we have forced all variables to be of type <code>"integer"</code> when importing the dataset.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="big-data-cleaning-and-transformation.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(flights)</span></code></pre></div>
<pre><code>##                       min        max       mean
## year             2013.000   2013.000   2013.000
## month               1.000     12.000      6.549
## day                 1.000     31.000     15.711
## dep_time            1.000   2400.000   1349.110
## sched_dep_time    106.000   2359.000   1344.255
## dep_delay         -43.000   1301.000     12.639
## arr_time            1.000   2400.000   1502.055
## sched_arr_time      1.000   2359.000   1536.380
## arr_delay         -86.000   1272.000      6.895
## carrier             9.000      9.000      9.000
## flight              1.000   8500.000   1971.924
## tailnum                                        
## origin                                         
## dest                                           
## air_time           20.000    695.000    150.686
## distance           17.000   4983.000   1039.913
## hour                1.000     23.000     13.180
## minute              0.000     59.000     26.230
## time_hour        2013.000   2014.000   2013.000
##                       NAs
## year                0.000
## month               0.000
## day                 0.000
## dep_time         8255.000
## sched_dep_time      0.000
## dep_delay        8255.000
## arr_time         8713.000
## sched_arr_time      0.000
## arr_delay        9430.000
## carrier        318316.000
## flight              0.000
## tailnum        336776.000
## origin         336776.000
## dest           336776.000
## air_time         9430.000
## distance            0.000
## hour                0.000
## minute              0.000
## time_hour           0.000</code></pre>
</div>
</div>
<div id="typical-cleaning-tasks" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Typical cleaning tasks</h2>
<ul>
<li>Normalize/standardize.</li>
<li>Code additional variables (indicators, strings to categorical, etc.).</li>
<li>Remove, add covariates.</li>
<li>Merge data sets.</li>
<li>Set data types.</li>
</ul>
<ol style="list-style-type: decimal">
<li>Import raw data.</li>
<li>Clean/transform.</li>
<li>Store for analysis.
<ul>
<li>Write to file.</li>
<li>Write to database.</li>
</ul></li>
</ol>
<ul>
<li>RAM:
<ul>
<li>Raw data does not fit into memory.</li>
<li>Transformations enlarge RAM allocation (copying).</li>
</ul></li>
<li>Mass Storage: Reading/Writing</li>
<li>CPU: Parsing (data types)</li>
</ul>
<div id="data-preparation-with-ff" class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Data Preparation with <code>ff</code></h3>
<div id="set-up" class="section level4" number="5.2.1.1">
<h4><span class="header-section-number">5.2.1.1</span> Set up</h4>
<p>The following examples are based on <span class="citation"><a href="references.html#ref-walkowiak_2016" role="doc-biblioref">Walkowiak</a> (<a href="references.html#ref-walkowiak_2016" role="doc-biblioref">2016</a>)</span>, Chapter 3. You can download the original datasets used in these examples from <a href="https://github.com/PacktPublishing/Big-Data-Analytics-with-R/tree/master/Chapter%203">the book’s GitHub repository</a>. The set up for our analysis script involves the loading of the <code>ff</code> and <code>ffbase</code> packages, the intitiation of fix variables to hold the paths to the data sets, as well as the creation and assignment of a new local directory <code>ffdf</code> in which the binary flat files-partitioned chunks of the original datasets will be stored.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="big-data-cleaning-and-transformation.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="do">## SET UP ------------------------</span></span>
<span id="cb170-2"><a href="big-data-cleaning-and-transformation.html#cb170-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-3"><a href="big-data-cleaning-and-transformation.html#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="co"># create and set directory for ff files</span></span>
<span id="cb170-4"><a href="big-data-cleaning-and-transformation.html#cb170-4" aria-hidden="true" tabindex="-1"></a><span class="fu">system</span>(<span class="st">&quot;mkdir ffdf&quot;</span>)</span>
<span id="cb170-5"><a href="big-data-cleaning-and-transformation.html#cb170-5" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">fftempdir =</span> <span class="st">&quot;ffdf&quot;</span>)</span>
<span id="cb170-6"><a href="big-data-cleaning-and-transformation.html#cb170-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-7"><a href="big-data-cleaning-and-transformation.html#cb170-7" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb170-8"><a href="big-data-cleaning-and-transformation.html#cb170-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ff)</span>
<span id="cb170-9"><a href="big-data-cleaning-and-transformation.html#cb170-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ffbase)</span>
<span id="cb170-10"><a href="big-data-cleaning-and-transformation.html#cb170-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pryr)</span>
<span id="cb170-11"><a href="big-data-cleaning-and-transformation.html#cb170-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-12"><a href="big-data-cleaning-and-transformation.html#cb170-12" aria-hidden="true" tabindex="-1"></a><span class="co"># fix vars</span></span>
<span id="cb170-13"><a href="big-data-cleaning-and-transformation.html#cb170-13" aria-hidden="true" tabindex="-1"></a>FLIGHTS_DATA <span class="ot">&lt;-</span> <span class="st">&quot;data/flights_sep_oct15.txt&quot;</span></span>
<span id="cb170-14"><a href="big-data-cleaning-and-transformation.html#cb170-14" aria-hidden="true" tabindex="-1"></a>AIRLINES_DATA <span class="ot">&lt;-</span> <span class="st">&quot;data/airline_id.csv&quot;</span></span></code></pre></div>
</div>
<div id="data-import" class="section level4" number="5.2.1.2">
<h4><span class="header-section-number">5.2.1.2</span> Data import</h4>
<p>In a first step we read (or ‘upload’) the data into R. This step involves the creation of the binary chunked files as well as the mapping of these files and the metadata. In comparison to the traditional <code>read.csv</code> approach, you will notice two things. On the one hand the data import takes longer, on the other hand it uses up much less RAM than than with <code>read.csv</code>.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="big-data-cleaning-and-transformation.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DATA IMPORT ------------------</span></span>
<span id="cb171-2"><a href="big-data-cleaning-and-transformation.html#cb171-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-3"><a href="big-data-cleaning-and-transformation.html#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="co"># check memory used</span></span>
<span id="cb171-4"><a href="big-data-cleaning-and-transformation.html#cb171-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mem_used</span>()</span></code></pre></div>
<pre><code>## 1.09 GB</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="big-data-cleaning-and-transformation.html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Upload flights_sep_oct15.txt and airline_id.csv files from flat files. </span></span>
<span id="cb173-2"><a href="big-data-cleaning-and-transformation.html#cb173-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-3"><a href="big-data-cleaning-and-transformation.html#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(flights.ff <span class="ot">&lt;-</span> <span class="fu">read.table.ffdf</span>(<span class="at">file=</span>FLIGHTS_DATA,</span>
<span id="cb173-4"><a href="big-data-cleaning-and-transformation.html#cb173-4" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">sep=</span><span class="st">&quot;,&quot;</span>,</span>
<span id="cb173-5"><a href="big-data-cleaning-and-transformation.html#cb173-5" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">VERBOSE=</span><span class="cn">TRUE</span>,</span>
<span id="cb173-6"><a href="big-data-cleaning-and-transformation.html#cb173-6" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">header=</span><span class="cn">TRUE</span>,</span>
<span id="cb173-7"><a href="big-data-cleaning-and-transformation.html#cb173-7" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">next.rows=</span><span class="dv">100000</span>,</span>
<span id="cb173-8"><a href="big-data-cleaning-and-transformation.html#cb173-8" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">colClasses=</span><span class="cn">NA</span>))</span></code></pre></div>
<pre><code>## read.table.ffdf 1..100000 (100000)  csv-read=0.458sec ffdf-write=0.062sec
## read.table.ffdf 100001..200000 (100000)  csv-read=0.475sec ffdf-write=0.043sec
## read.table.ffdf 200001..300000 (100000)  csv-read=0.474sec ffdf-write=0.051sec
## read.table.ffdf 300001..400000 (100000)  csv-read=0.492sec ffdf-write=0.058sec
## read.table.ffdf 400001..500000 (100000)  csv-read=0.48sec ffdf-write=0.043sec
## read.table.ffdf 500001..600000 (100000)  csv-read=0.484sec ffdf-write=0.045sec
## read.table.ffdf 600001..700000 (100000)  csv-read=0.486sec ffdf-write=0.046sec
## read.table.ffdf 700001..800000 (100000)  csv-read=0.48sec ffdf-write=0.048sec
## read.table.ffdf 800001..900000 (100000)  csv-read=0.484sec ffdf-write=0.055sec
## read.table.ffdf 900001..951111 (51111)  csv-read=0.244sec ffdf-write=0.03sec
##  csv-read=4.557sec  ffdf-write=0.481sec  TOTAL=5.038sec</code></pre>
<pre><code>##    user  system elapsed 
##   4.892   0.147   5.040</code></pre>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="big-data-cleaning-and-transformation.html#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(airlines.ff <span class="ot">&lt;-</span> <span class="fu">read.csv.ffdf</span>(<span class="at">file=</span> AIRLINES_DATA,</span>
<span id="cb176-2"><a href="big-data-cleaning-and-transformation.html#cb176-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">VERBOSE=</span><span class="cn">TRUE</span>,</span>
<span id="cb176-3"><a href="big-data-cleaning-and-transformation.html#cb176-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">header=</span><span class="cn">TRUE</span>,</span>
<span id="cb176-4"><a href="big-data-cleaning-and-transformation.html#cb176-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">next.rows=</span><span class="dv">100000</span>,</span>
<span id="cb176-5"><a href="big-data-cleaning-and-transformation.html#cb176-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">colClasses=</span><span class="cn">NA</span>))</span></code></pre></div>
<pre><code>## read.table.ffdf 1..1607 (1607)  csv-read=0.005sec ffdf-write=0.003sec
##  csv-read=0.005sec  ffdf-write=0.003sec  TOTAL=0.008sec</code></pre>
<pre><code>##    user  system elapsed 
##   0.008   0.000   0.008</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="big-data-cleaning-and-transformation.html#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check memory used</span></span>
<span id="cb179-2"><a href="big-data-cleaning-and-transformation.html#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mem_used</span>()</span></code></pre></div>
<pre><code>## 1.09 GB</code></pre>
<p>Comparison with <code>read.table</code></p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="big-data-cleaning-and-transformation.html#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Using read.table()</span></span>
<span id="cb181-2"><a href="big-data-cleaning-and-transformation.html#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(flights.table <span class="ot">&lt;-</span> <span class="fu">read.table</span>(FLIGHTS_DATA, </span>
<span id="cb181-3"><a href="big-data-cleaning-and-transformation.html#cb181-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">sep=</span><span class="st">&quot;,&quot;</span>,</span>
<span id="cb181-4"><a href="big-data-cleaning-and-transformation.html#cb181-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">header=</span><span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>##    user  system elapsed 
##   4.605   0.075   4.681</code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="big-data-cleaning-and-transformation.html#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##             used   (Mb) gc trigger   (Mb)  max used
## Ncells   1301902   69.6    2027135  108.3   2027135
## Vcells 145068826 1106.8  213478480 1628.8 212853698
##          (Mb)
## Ncells  108.3
## Vcells 1624.0</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="big-data-cleaning-and-transformation.html#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(airlines.table <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(AIRLINES_DATA,</span>
<span id="cb185-2"><a href="big-data-cleaning-and-transformation.html#cb185-2" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">header =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>##    user  system elapsed 
##   0.001   0.000   0.002</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="big-data-cleaning-and-transformation.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check memory used</span></span>
<span id="cb187-2"><a href="big-data-cleaning-and-transformation.html#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mem_used</span>()</span></code></pre></div>
<pre><code>## 1.23 GB</code></pre>
</div>
<div id="inspect-imported-files" class="section level4" number="5.2.1.3">
<h4><span class="header-section-number">5.2.1.3</span> Inspect imported files</h4>
<p>A particularly useful aspect of working with the ff-package and the packages building on them is that many of the simple R functions that work on usual data.frames in RAM also work on ffdfs. Hence, without actually having loaded the entire raw data of a large dataset into RAM, we can quickly get an overview of the key characteristics such as the number of observations and the number of variables.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="big-data-cleaning-and-transformation.html#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Inspect the ffdf objects.</span></span>
<span id="cb189-2"><a href="big-data-cleaning-and-transformation.html#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="do">## For flights.ff object:</span></span>
<span id="cb189-3"><a href="big-data-cleaning-and-transformation.html#cb189-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(flights.ff)</span></code></pre></div>
<pre><code>## [1] &quot;ffdf&quot;</code></pre>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="big-data-cleaning-and-transformation.html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(flights.ff)</span></code></pre></div>
<pre><code>## [1] 951111     28</code></pre>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="big-data-cleaning-and-transformation.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="do">## For airlines.ff object:</span></span>
<span id="cb193-2"><a href="big-data-cleaning-and-transformation.html#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(airlines.ff)</span></code></pre></div>
<pre><code>## [1] &quot;ffdf&quot;</code></pre>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="big-data-cleaning-and-transformation.html#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(airlines.ff)</span></code></pre></div>
<pre><code>## [1] 1607    2</code></pre>
</div>
<div id="data-cleaning-and-transformation" class="section level4" number="5.2.1.4">
<h4><span class="header-section-number">5.2.1.4</span> Data cleaning and transformation</h4>
<p>After inspecting the data, we go through several steps of cleaning and transformation, with the goal of then merging the two datasets. That is, we want to create a new dataset that contains detailed flights information but with additional information on the carriers/airlines. First, we want to rename some of the variables.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="big-data-cleaning-and-transformation.html#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># step 1: </span></span>
<span id="cb197-2"><a href="big-data-cleaning-and-transformation.html#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Rename &quot;Code&quot; variable from airlines.ff to &quot;AIRLINE_ID&quot; and &quot;Description&quot; into &quot;AIRLINE_NM&quot;.</span></span>
<span id="cb197-3"><a href="big-data-cleaning-and-transformation.html#cb197-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(airlines.ff) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;AIRLINE_ID&quot;</span>, <span class="st">&quot;AIRLINE_NM&quot;</span>)</span>
<span id="cb197-4"><a href="big-data-cleaning-and-transformation.html#cb197-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(airlines.ff)</span></code></pre></div>
<pre><code>## [1] &quot;AIRLINE_ID&quot; &quot;AIRLINE_NM&quot;</code></pre>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="big-data-cleaning-and-transformation.html#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(airlines.ff[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,])</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    20 obs. of  2 variables:
##  $ AIRLINE_ID: int  19031 19032 19033 19034 19035 19036 19037 19038 19039 19040 ...
##  $ AIRLINE_NM: Factor w/ 1607 levels &quot;40-Mile Air: Q5&quot;,..: 945 1025 503 721 64 725 1194 99 1395 276 ...</code></pre>
<p>Now we can join the two datasets via the unique airline identifier <code>"AIRLINE_ID"</code>. Note that these kind of operations would usually take up substantially more RAM on the spot, if both original datasets would also be fully loaded into RAM. As illustrated by the <code>mem_change()</code>-function, this is not the case here. All that is needed is a small chunk of RAM to keep the metadata and mapping-information of the new <code>ffdf</code> object, all the actual data is cached on the hard disk.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="big-data-cleaning-and-transformation.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merge of ffdf objects</span></span>
<span id="cb201-2"><a href="big-data-cleaning-and-transformation.html#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mem_change</span>(flights.data.ff <span class="ot">&lt;-</span> <span class="fu">merge.ffdf</span>(flights.ff, airlines.ff, <span class="at">by=</span><span class="st">&quot;AIRLINE_ID&quot;</span>))</span></code></pre></div>
<pre><code>## 781 kB</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="big-data-cleaning-and-transformation.html#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The new object is only 551.2 Kb in size</span></span>
<span id="cb203-2"><a href="big-data-cleaning-and-transformation.html#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(flights.data.ff)</span></code></pre></div>
<pre><code>## [1] &quot;ffdf&quot;</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="big-data-cleaning-and-transformation.html#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(flights.data.ff)</span></code></pre></div>
<pre><code>## [1] 951111     29</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="big-data-cleaning-and-transformation.html#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(flights.data.ff)</span></code></pre></div>
<pre><code>##  [1] &quot;YEAR&quot;              &quot;MONTH&quot;            
##  [3] &quot;DAY_OF_MONTH&quot;      &quot;DAY_OF_WEEK&quot;      
##  [5] &quot;FL_DATE&quot;           &quot;UNIQUE_CARRIER&quot;   
##  [7] &quot;AIRLINE_ID&quot;        &quot;TAIL_NUM&quot;         
##  [9] &quot;FL_NUM&quot;            &quot;ORIGIN_AIRPORT_ID&quot;
## [11] &quot;ORIGIN&quot;            &quot;ORIGIN_CITY_NAME&quot; 
## [13] &quot;ORIGIN_STATE_NM&quot;   &quot;ORIGIN_WAC&quot;       
## [15] &quot;DEST_AIRPORT_ID&quot;   &quot;DEST&quot;             
## [17] &quot;DEST_CITY_NAME&quot;    &quot;DEST_STATE_NM&quot;    
## [19] &quot;DEST_WAC&quot;          &quot;DEP_TIME&quot;         
## [21] &quot;DEP_DELAY&quot;         &quot;ARR_TIME&quot;         
## [23] &quot;ARR_DELAY&quot;         &quot;CANCELLED&quot;        
## [25] &quot;CANCELLATION_CODE&quot; &quot;DIVERTED&quot;         
## [27] &quot;AIR_TIME&quot;          &quot;DISTANCE&quot;         
## [29] &quot;AIRLINE_NM&quot;</code></pre>
<p>Inspect difference to in-memory operation</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="big-data-cleaning-and-transformation.html#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="do">##For flights.table:</span></span>
<span id="cb209-2"><a href="big-data-cleaning-and-transformation.html#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(airlines.table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;AIRLINE_ID&quot;</span>, <span class="st">&quot;AIRLINE_NM&quot;</span>)</span>
<span id="cb209-3"><a href="big-data-cleaning-and-transformation.html#cb209-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(airlines.table)</span></code></pre></div>
<pre><code>## [1] &quot;AIRLINE_ID&quot; &quot;AIRLINE_NM&quot;</code></pre>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="big-data-cleaning-and-transformation.html#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(airlines.table[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,])</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    20 obs. of  2 variables:
##  $ AIRLINE_ID: int  19031 19032 19033 19034 19035 19036 19037 19038 19039 19040 ...
##  $ AIRLINE_NM: chr  &quot;Mackey International Inc.: MAC&quot; &quot;Munz Northern Airlines Inc.: XY&quot; &quot;Cochise Airlines Inc.: COC&quot; &quot;Golden Gate Airlines Inc.: GSA&quot; ...</code></pre>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="big-data-cleaning-and-transformation.html#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check memory usage of merge in RAM </span></span>
<span id="cb213-2"><a href="big-data-cleaning-and-transformation.html#cb213-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mem_change</span>(flights.data.table <span class="ot">&lt;-</span> <span class="fu">merge</span>(flights.table,</span>
<span id="cb213-3"><a href="big-data-cleaning-and-transformation.html#cb213-3" aria-hidden="true" tabindex="-1"></a>                                       airlines.table,</span>
<span id="cb213-4"><a href="big-data-cleaning-and-transformation.html#cb213-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">by=</span><span class="st">&quot;AIRLINE_ID&quot;</span>))</span></code></pre></div>
<pre><code>## 160 MB</code></pre>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="big-data-cleaning-and-transformation.html#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The new object is already 105.7 Mb in size</span></span>
<span id="cb215-2"><a href="big-data-cleaning-and-transformation.html#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="co">#A rapid spike in RAM use when processing</span></span></code></pre></div>
</div>
<div id="subsetting" class="section level4" number="5.2.1.5">
<h4><span class="header-section-number">5.2.1.5</span> Subsetting</h4>
<p>Now, we want to filter out some observations as well as select only specific variables for a subset of the overall dataset.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="big-data-cleaning-and-transformation.html#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mem_used</span>()</span></code></pre></div>
<pre><code>## 1.39 GB</code></pre>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="big-data-cleaning-and-transformation.html#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset the ffdf object flights.data.ff:</span></span>
<span id="cb218-2"><a href="big-data-cleaning-and-transformation.html#cb218-2" aria-hidden="true" tabindex="-1"></a>subs1.ff <span class="ot">&lt;-</span> <span class="fu">subset.ffdf</span>(flights.data.ff, CANCELLED <span class="sc">==</span> <span class="dv">1</span>, </span>
<span id="cb218-3"><a href="big-data-cleaning-and-transformation.html#cb218-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">select =</span> <span class="fu">c</span>(FL_DATE, AIRLINE_ID, </span>
<span id="cb218-4"><a href="big-data-cleaning-and-transformation.html#cb218-4" aria-hidden="true" tabindex="-1"></a>                                   ORIGIN_CITY_NAME,</span>
<span id="cb218-5"><a href="big-data-cleaning-and-transformation.html#cb218-5" aria-hidden="true" tabindex="-1"></a>                                   ORIGIN_STATE_NM,</span>
<span id="cb218-6"><a href="big-data-cleaning-and-transformation.html#cb218-6" aria-hidden="true" tabindex="-1"></a>                                   DEST_CITY_NAME,</span>
<span id="cb218-7"><a href="big-data-cleaning-and-transformation.html#cb218-7" aria-hidden="true" tabindex="-1"></a>                                   DEST_STATE_NM,</span>
<span id="cb218-8"><a href="big-data-cleaning-and-transformation.html#cb218-8" aria-hidden="true" tabindex="-1"></a>                                   CANCELLATION_CODE))</span>
<span id="cb218-9"><a href="big-data-cleaning-and-transformation.html#cb218-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-10"><a href="big-data-cleaning-and-transformation.html#cb218-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(subs1.ff)</span></code></pre></div>
<pre><code>## [1] 4529    7</code></pre>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="big-data-cleaning-and-transformation.html#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mem_used</span>()</span></code></pre></div>
<pre><code>## 1.39 GB</code></pre>
</div>
<div id="saveloadexport-ffdf-files" class="section level4" number="5.2.1.6">
<h4><span class="header-section-number">5.2.1.6</span> Save/load/export ffdf-files</h4>
<p>In order to better organize and easily reload newly created <code>ffdf</code>s, we can explicitly save them to disk.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="big-data-cleaning-and-transformation.html#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save a newly created ffdf object to a data file:</span></span>
<span id="cb222-2"><a href="big-data-cleaning-and-transformation.html#cb222-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-3"><a href="big-data-cleaning-and-transformation.html#cb222-3" aria-hidden="true" tabindex="-1"></a><span class="fu">save.ffdf</span>(subs1.ff, <span class="at">overwrite =</span> <span class="cn">TRUE</span>) <span class="co">#7 files (one for each column) created in the ffdb directory</span></span></code></pre></div>
<p>If we want to reload a previously saved <code>ffdf</code>, we do not have to go through the chunking of a raw data file again, but can very quickly load the data mapping and metadata into RAM in order to further work with the data (stored on disk).</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="big-data-cleaning-and-transformation.html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading previously saved ffdf files:</span></span>
<span id="cb223-2"><a href="big-data-cleaning-and-transformation.html#cb223-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(subs1.ff)</span>
<span id="cb223-3"><a href="big-data-cleaning-and-transformation.html#cb223-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##             used   (Mb) gc trigger   (Mb)  max used
## Ncells   1322394   70.7    4391254  234.6   3203969
## Vcells 165059326 1259.4  256254176 1955.1 212853698
##          (Mb)
## Ncells  171.2
## Vcells 1624.0</code></pre>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="big-data-cleaning-and-transformation.html#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load.ffdf</span>(<span class="st">&quot;ffdb&quot;</span>)</span>
<span id="cb225-2"><a href="big-data-cleaning-and-transformation.html#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="co"># check the class and structure of the loaded data</span></span>
<span id="cb225-3"><a href="big-data-cleaning-and-transformation.html#cb225-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(subs1.ff) </span></code></pre></div>
<pre><code>## [1] &quot;ffdf&quot;</code></pre>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="big-data-cleaning-and-transformation.html#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(subs1.ff)</span></code></pre></div>
<pre><code>## List of 3
##  $ virtual: &#39;data.frame&#39;:    7 obs. of  7 variables:
##  .. $ VirtualVmode     : chr  &quot;integer&quot; &quot;integer&quot; &quot;integer&quot; &quot;integer&quot; ...
##  .. $ AsIs             : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
##  .. $ VirtualIsMatrix  : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
##  .. $ PhysicalIsMatrix : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
##  .. $ PhysicalElementNo: int  1 2 3 4 5 6 7
##  .. $ PhysicalFirstCol : int  1 1 1 1 1 1 1
##  .. $ PhysicalLastCol  : int  1 1 1 1 1 1 1
##  .. - attr(*, &quot;Dim&quot;)= int [1:2] 4529 7
##  .. - attr(*, &quot;Dimorder&quot;)= int [1:2] 1 2
##  $ physical: List of 7
##  .. $ FL_DATE          : list()
##  ..  ..- attr(*, &quot;physical&quot;)=Class &#39;ff_pointer&#39; &lt;externalptr&gt; 
##  ..  .. ..- attr(*, &quot;vmode&quot;)= chr &quot;integer&quot;
##  ..  .. ..- attr(*, &quot;maxlength&quot;)= int 4529
##  ..  .. ..- attr(*, &quot;pattern&quot;)= chr &quot;ffdf&quot;
##  ..  .. ..- attr(*, &quot;filename&quot;)= chr &quot;/home/umatter/Dropbox/Teaching/HSG/BigData/BigData/ffdb/subs1.ff$FL_DATE.ff&quot;
##  ..  .. ..- attr(*, &quot;pagesize&quot;)= int 65536
##  ..  .. ..- attr(*, &quot;finalizer&quot;)= chr &quot;close&quot;
##  ..  .. ..- attr(*, &quot;finonexit&quot;)= logi TRUE
##  ..  .. ..- attr(*, &quot;readonly&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;caching&quot;)= chr &quot;mmnoflush&quot;
##  ..  ..- attr(*, &quot;virtual&quot;)= list()
##  ..  .. ..- attr(*, &quot;Length&quot;)= int 4529
##  ..  .. ..- attr(*, &quot;Symmetric&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;Levels&quot;)= chr [1:61] &quot;2015-09-01&quot; &quot;2015-09-02&quot; &quot;2015-09-03&quot; &quot;2015-09-04&quot; ...
##  ..  .. ..- attr(*, &quot;ramclass&quot;)= chr &quot;factor&quot;
##  .. .. - attr(*, &quot;class&quot;) =  chr [1:2] &quot;ff_vector&quot; &quot;ff&quot;
##  .. $ AIRLINE_ID       : list()
##  ..  ..- attr(*, &quot;physical&quot;)=Class &#39;ff_pointer&#39; &lt;externalptr&gt; 
##  ..  .. ..- attr(*, &quot;vmode&quot;)= chr &quot;integer&quot;
##  ..  .. ..- attr(*, &quot;maxlength&quot;)= int 4529
##  ..  .. ..- attr(*, &quot;pattern&quot;)= chr &quot;ffdf&quot;
##  ..  .. ..- attr(*, &quot;filename&quot;)= chr &quot;/home/umatter/Dropbox/Teaching/HSG/BigData/BigData/ffdb/subs1.ff$AIRLINE_ID.ff&quot;
##  ..  .. ..- attr(*, &quot;pagesize&quot;)= int 65536
##  ..  .. ..- attr(*, &quot;finalizer&quot;)= chr &quot;close&quot;
##  ..  .. ..- attr(*, &quot;finonexit&quot;)= logi TRUE
##  ..  .. ..- attr(*, &quot;readonly&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;caching&quot;)= chr &quot;mmnoflush&quot;
##  ..  ..- attr(*, &quot;virtual&quot;)= list()
##  ..  .. ..- attr(*, &quot;Length&quot;)= int 4529
##  ..  .. ..- attr(*, &quot;Symmetric&quot;)= logi FALSE
##  .. .. - attr(*, &quot;class&quot;) =  chr [1:2] &quot;ff_vector&quot; &quot;ff&quot;
##  .. $ ORIGIN_CITY_NAME : list()
##  ..  ..- attr(*, &quot;physical&quot;)=Class &#39;ff_pointer&#39; &lt;externalptr&gt; 
##  ..  .. ..- attr(*, &quot;vmode&quot;)= chr &quot;integer&quot;
##  ..  .. ..- attr(*, &quot;maxlength&quot;)= int 4529
##  ..  .. ..- attr(*, &quot;pattern&quot;)= chr &quot;ffdf&quot;
##  ..  .. ..- attr(*, &quot;filename&quot;)= chr &quot;/home/umatter/Dropbox/Teaching/HSG/BigData/BigData/ffdb/subs1.ff$ORIGIN_CITY_NAME.ff&quot;
##  ..  .. ..- attr(*, &quot;pagesize&quot;)= int 65536
##  ..  .. ..- attr(*, &quot;finalizer&quot;)= chr &quot;close&quot;
##  ..  .. ..- attr(*, &quot;finonexit&quot;)= logi TRUE
##  ..  .. ..- attr(*, &quot;readonly&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;caching&quot;)= chr &quot;mmnoflush&quot;
##  ..  ..- attr(*, &quot;virtual&quot;)= list()
##  ..  .. ..- attr(*, &quot;Length&quot;)= int 4529
##  ..  .. ..- attr(*, &quot;Symmetric&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;Levels&quot;)= chr [1:305] &quot;Abilene, TX&quot; &quot;Akron, OH&quot; &quot;Albany, GA&quot; &quot;Albany, NY&quot; ...
##  ..  .. ..- attr(*, &quot;ramclass&quot;)= chr &quot;factor&quot;
##  .. .. - attr(*, &quot;class&quot;) =  chr [1:2] &quot;ff_vector&quot; &quot;ff&quot;
##  .. $ ORIGIN_STATE_NM  : list()
##  ..  ..- attr(*, &quot;physical&quot;)=Class &#39;ff_pointer&#39; &lt;externalptr&gt; 
##  ..  .. ..- attr(*, &quot;vmode&quot;)= chr &quot;integer&quot;
##  ..  .. ..- attr(*, &quot;maxlength&quot;)= int 4529
##  ..  .. ..- attr(*, &quot;pattern&quot;)= chr &quot;ffdf&quot;
##  ..  .. ..- attr(*, &quot;filename&quot;)= chr &quot;/home/umatter/Dropbox/Teaching/HSG/BigData/BigData/ffdb/subs1.ff$ORIGIN_STATE_NM.ff&quot;
##  ..  .. ..- attr(*, &quot;pagesize&quot;)= int 65536
##  ..  .. ..- attr(*, &quot;finalizer&quot;)= chr &quot;close&quot;
##  ..  .. ..- attr(*, &quot;finonexit&quot;)= logi TRUE
##  ..  .. ..- attr(*, &quot;readonly&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;caching&quot;)= chr &quot;mmnoflush&quot;
##  ..  ..- attr(*, &quot;virtual&quot;)= list()
##  ..  .. ..- attr(*, &quot;Length&quot;)= int 4529
##  ..  .. ..- attr(*, &quot;Symmetric&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;Levels&quot;)= chr [1:52] &quot;Alabama&quot; &quot;Alaska&quot; &quot;Arizona&quot; &quot;Arkansas&quot; ...
##  ..  .. ..- attr(*, &quot;ramclass&quot;)= chr &quot;factor&quot;
##  .. .. - attr(*, &quot;class&quot;) =  chr [1:2] &quot;ff_vector&quot; &quot;ff&quot;
##  .. $ DEST_CITY_NAME   : list()
##  ..  ..- attr(*, &quot;physical&quot;)=Class &#39;ff_pointer&#39; &lt;externalptr&gt; 
##  ..  .. ..- attr(*, &quot;vmode&quot;)= chr &quot;integer&quot;
##  ..  .. ..- attr(*, &quot;maxlength&quot;)= int 4529
##  ..  .. ..- attr(*, &quot;pattern&quot;)= chr &quot;ffdf&quot;
##  ..  .. ..- attr(*, &quot;filename&quot;)= chr &quot;/home/umatter/Dropbox/Teaching/HSG/BigData/BigData/ffdb/subs1.ff$DEST_CITY_NAME.ff&quot;
##  ..  .. ..- attr(*, &quot;pagesize&quot;)= int 65536
##  ..  .. ..- attr(*, &quot;finalizer&quot;)= chr &quot;close&quot;
##  ..  .. ..- attr(*, &quot;finonexit&quot;)= logi TRUE
##  ..  .. ..- attr(*, &quot;readonly&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;caching&quot;)= chr &quot;mmnoflush&quot;
##  ..  ..- attr(*, &quot;virtual&quot;)= list()
##  ..  .. ..- attr(*, &quot;Length&quot;)= int 4529
##  ..  .. ..- attr(*, &quot;Symmetric&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;Levels&quot;)= chr [1:306] &quot;Abilene, TX&quot; &quot;Akron, OH&quot; &quot;Albany, GA&quot; &quot;Albany, NY&quot; ...
##  ..  .. ..- attr(*, &quot;ramclass&quot;)= chr &quot;factor&quot;
##  .. .. - attr(*, &quot;class&quot;) =  chr [1:2] &quot;ff_vector&quot; &quot;ff&quot;
##  .. $ DEST_STATE_NM    : list()
##  ..  ..- attr(*, &quot;physical&quot;)=Class &#39;ff_pointer&#39; &lt;externalptr&gt; 
##  ..  .. ..- attr(*, &quot;vmode&quot;)= chr &quot;integer&quot;
##  ..  .. ..- attr(*, &quot;maxlength&quot;)= int 4529
##  ..  .. ..- attr(*, &quot;pattern&quot;)= chr &quot;ffdf&quot;
##  ..  .. ..- attr(*, &quot;filename&quot;)= chr &quot;/home/umatter/Dropbox/Teaching/HSG/BigData/BigData/ffdb/subs1.ff$DEST_STATE_NM.ff&quot;
##  ..  .. ..- attr(*, &quot;pagesize&quot;)= int 65536
##  ..  .. ..- attr(*, &quot;finalizer&quot;)= chr &quot;close&quot;
##  ..  .. ..- attr(*, &quot;finonexit&quot;)= logi TRUE
##  ..  .. ..- attr(*, &quot;readonly&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;caching&quot;)= chr &quot;mmnoflush&quot;
##  ..  ..- attr(*, &quot;virtual&quot;)= list()
##  ..  .. ..- attr(*, &quot;Length&quot;)= int 4529
##  ..  .. ..- attr(*, &quot;Symmetric&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;Levels&quot;)= chr [1:52] &quot;Alabama&quot; &quot;Alaska&quot; &quot;Arizona&quot; &quot;Arkansas&quot; ...
##  ..  .. ..- attr(*, &quot;ramclass&quot;)= chr &quot;factor&quot;
##  .. .. - attr(*, &quot;class&quot;) =  chr [1:2] &quot;ff_vector&quot; &quot;ff&quot;
##  .. $ CANCELLATION_CODE: list()
##  ..  ..- attr(*, &quot;physical&quot;)=Class &#39;ff_pointer&#39; &lt;externalptr&gt; 
##  ..  .. ..- attr(*, &quot;vmode&quot;)= chr &quot;integer&quot;
##  ..  .. ..- attr(*, &quot;maxlength&quot;)= int 4529
##  ..  .. ..- attr(*, &quot;pattern&quot;)= chr &quot;ffdf&quot;
##  ..  .. ..- attr(*, &quot;filename&quot;)= chr &quot;/home/umatter/Dropbox/Teaching/HSG/BigData/BigData/ffdb/subs1.ff$CANCELLATION_CODE.ff&quot;
##  ..  .. ..- attr(*, &quot;pagesize&quot;)= int 65536
##  ..  .. ..- attr(*, &quot;finalizer&quot;)= chr &quot;close&quot;
##  ..  .. ..- attr(*, &quot;finonexit&quot;)= logi TRUE
##  ..  .. ..- attr(*, &quot;readonly&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;caching&quot;)= chr &quot;mmnoflush&quot;
##  ..  ..- attr(*, &quot;virtual&quot;)= list()
##  ..  .. ..- attr(*, &quot;Length&quot;)= int 4529
##  ..  .. ..- attr(*, &quot;Symmetric&quot;)= logi FALSE
##  ..  .. ..- attr(*, &quot;Levels&quot;)= chr [1:4] &quot;&quot; &quot;A&quot; &quot;B&quot; &quot;C&quot;
##  ..  .. ..- attr(*, &quot;ramclass&quot;)= chr &quot;factor&quot;
##  .. .. - attr(*, &quot;class&quot;) =  chr [1:2] &quot;ff_vector&quot; &quot;ff&quot;
##  $ row.names:  NULL
## - attributes: List of 2
##  .. $ names: chr [1:2] &quot;virtual&quot; &quot;physical&quot;
##  .. $ class: chr &quot;ffdf&quot;</code></pre>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="big-data-cleaning-and-transformation.html#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(subs1.ff)</span></code></pre></div>
<pre><code>## [1] 4529    7</code></pre>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="big-data-cleaning-and-transformation.html#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(subs1.ff)</span></code></pre></div>
<pre><code>## [[1]]
## NULL
## 
## [[2]]
## [1] &quot;FL_DATE&quot;           &quot;AIRLINE_ID&quot;       
## [3] &quot;ORIGIN_CITY_NAME&quot;  &quot;ORIGIN_STATE_NM&quot;  
## [5] &quot;DEST_CITY_NAME&quot;    &quot;DEST_STATE_NM&quot;    
## [7] &quot;CANCELLATION_CODE&quot;</code></pre>
<p>In case we want to store an <code>ffdf</code> dataset in a format more accessible for other users (such as csv), we can do so as follows. This last step is also quite common in practice. The initial raw data set is very large, thus we perform all the theoretically very memory-intense tasks of preparing the analytic dataset via <code>ff</code> and then store the (often much smaller) analytic dataset in a more accessible csv file in order to later read it into RAM and run more computationally intense analyses directly in RAM.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="big-data-cleaning-and-transformation.html#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Export subs1.ff into CSV and TXT files:</span></span>
<span id="cb233-2"><a href="big-data-cleaning-and-transformation.html#cb233-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv.ffdf</span>(subs1.ff, <span class="st">&quot;subset1.csv&quot;</span>)</span></code></pre></div>

</div>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="7">
<li id="fn7"><p>We only use a fraction of the data used in the package vignette example, the full raw data used there can be downloaded <a href="http://stat-computing.org/dataexpo/2009/the-data.html">here</a>.<a href="big-data-cleaning-and-transformation.html#fnref7" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="advanced-r-programming.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-aggregation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 1
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bigdata.pdf", "bigdata.html", "bigdata.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
